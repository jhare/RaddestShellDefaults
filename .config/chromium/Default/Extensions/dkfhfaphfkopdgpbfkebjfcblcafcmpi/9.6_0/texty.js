var _gaq=_gaq||[];_gaq.push(["_setAccount","UA-21391541-2"]);_gaq.push(["_trackPageview"]);(function(){var a=document.createElement("script");a.type="text/javascript";a.async=!0;a.src="https://ssl.google-analytics.com/ga.js";var b=document.getElementsByTagName("script")[0];b.parentNode.insertBefore(a,b)})();var _kmq=_kmq||[],_kmk=_kmk||"a009d9e3633da7d7456e8e1478c8f05f33e35f8e";
function _kms(a){setTimeout(function(){var b=document,c=b.getElementsByTagName("script")[0],b=b.createElement("script");b.type="text/javascript";b.async=!0;b.src=a;c.parentNode.insertBefore(b,c)},1)}_kms("https://i.kissmetrics.com/i.js");_kms("https://doug1izaerwt3.cloudfront.net/"+_kmk+".1.js");
var network_connection_status=!1,notification_no_network_connection,notification_general_error_global,contacts=[],which_phone_num_for_notif="000000",apiVersion=5,baseUrl="https://textyserver.appspot.com",textyStaticServerURL="http://textyapp.com",globalIntervalGetPhoneStatus,sendUrl=baseUrl+"/client?function=send",signInUrlCRX=baseUrl+"/signin?extret="+encodeURIComponent(chrome.extension.getURL("help.html"))+"%23signed_in&ver="+apiVersion,signOutUrl=baseUrl+"/signout?extret="+encodeURIComponent(chrome.extension.getURL("signed_out.html"))+
"&ver="+apiVersion,registerUrl=baseUrl+"/register?ver="+apiVersion,STATUS_SUCCESS="success",STATUS_LOGIN_REQUIRED="login_required",STATUS_DEVICE_NOT_REGISTERED="device_not_registered",STATUS_GENERAL_ERROR="general_error",BROWSER_CHANNEL_RETRY_INTERVAL_MS=1E4*(1+Math.random()-0.5),channel,socket,phone_number,globalLastKnownGoogleUserName="none";
function _3b0a65b2762a720f13071fc19d875c5b11736a35b4c6415dbd9336d9979899193072fe9e0b9314b6(a){a?chrome.browserAction.setIcon({path:"img/mt_new_19x19.png"}):chrome.browserAction.setIcon({path:"img/icon-19-off.png"})}var NEW_COUNT_GLOBAL_NOTIF=0;
function _6f7d39edeb231fae5cd42be4b9ba562efe34cc86a8869a0a430be08287d5d89db4e2b1524d81c2f9(){var a=NEW_COUNT_GLOBAL_NOTIF;10<NEW_COUNT_GLOBAL_NOTIF&&(a="10plus");_gaq.push(["_trackEvent","CRX-Background","Error","getUserInfo-CRX-GU72-"+a,1]);console.log("----------------");NEW_COUNT_GLOBAL_NOTIF++;2>NEW_COUNT_GLOBAL_NOTIF&&(a=window.webkitNotifications.createNotification("error_icon.png","MightyText Connection Issue","Error connecting to MightyText. If this error continues, please inform our team. We are sorry for the inconvenience.(Error Code: CRX-GU72)"),
a.ondisplay=function(a){setTimeout(function(){a.currentTarget.cancel()},1E4)},a.show())}
function _46ac7ba195a5dcf861882f118aec028d8f27552d142765652f6f9656b2b2e569fcfae840ef95c4ba(){_gaq.push(["_trackEvent","CRX-Background","Error","getDistinctHeaders-CRX-GTHRD59",1]);console.log("----------------");if(1>NEW_COUNT_GLOBAL_NOTIF){var a=window.webkitNotifications.createNotification("error_icon.png","MightyText System issues","MightyText is having system issues. We're aware of the problem and working on it. We are sorry for the inconvenience. (Error Code: CRX-GTHRD59)");a.ondisplay=function(a){setTimeout(function(){a.currentTarget.cancel()},
1E4)};a.show()}}
function _2486d2c07c09f912627492dba7ef11e8fa4c906312c0c5d82ca8e740b84f316d4d2233fb86058add(){_gaq.push(["_trackEvent","Background","CAPI-Experiment-On",google_username_currently_logged_in,1]);capi_rollout_factor=2.8;_23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b("CAPI RolloutFactor in experiment is: "+capi_rollout_factor);clearInterval(currentGlobalIntervalID);poll_freq*=capi_rollout_factor;currentGlobalIntervalID=window.setInterval(function(){_83970f4708993137bf6fdafd56f7f3d487d07e56659a9221e3acaf7b6979b98a51200e60c73b5740()},poll_freq);
console.log("poll_freq after capi check is "+poll_freq)}
function _7f09e80a68613cc54d2cb10a7e19bb40d6dc539aa5b1d7e217aa227d5b2b8a84920780cf637960e2(a,b,c,d){var e=new XMLHttpRequest;phone_number=dest_num;e.open("POST",sendUrl,!0);e.setRequestHeader("Content-Type","application/x-www-form-urlencoded");e.setRequestHeader("X-Same-Domain","true");e.onreadystatechange=function(){if(4==this.readyState)if(200==e.status){var a=e.responseText;0==a.indexOf("OK")?d(STATUS_SUCCESS,c,e):0==a.indexOf("LOGIN_REQUIRED")?d(STATUS_LOGIN_REQUIRED,c,e):0==a.indexOf("DEVICE_NOT_REGISTERED")&&
d(STATUS_DEVICE_NOT_REGISTERED,c,e)}else d(STATUS_GENERAL_ERROR,c,e)};if("send_sms"==a)var f="phone="+encodeURIComponent(phone_number)+"&deviceType=ac2dm&action=send_sms&action_data="+encodeURIComponent(b);else"mark_single_message_read"==a?(f="deviceType=ac2dm&action=mark_single_message_read&action_data="+encodeURIComponent(b),console.log(f)):"mark_whole_thread_read"==a&&(f="deviceType=ac2dm&action=mark_whole_thread_read&action_data="+encodeURIComponent(b));e.send(f)}
function _1a128ce00cdea089e7314a5760e11f131b8ef88156aba584644b57817efcf5b2a7d8dd1359d5fad4(a,b){var c=new XMLHttpRequest;phone_number=dest_num;c.open("POST",sendUrl,!0);c.setRequestHeader("Content-Type","application/x-www-form-urlencoded");c.setRequestHeader("X-Same-Domain","true");c.onreadystatechange=function(){if(4==this.readyState)if(200==c.status){var b=c.responseText;console.log("for C2DM call: "+a+"..... response received: "+b);0==b.indexOf("OK")?console.log(STATUS_SUCCESS):0==b.indexOf("LOGIN_REQUIRED")?
console.log(STATUS_LOGIN_REQUIRED):0==b.indexOf("DEVICE_NOT_REGISTERED")&&console.log(STATUS_DEVICE_NOT_REGISTERED)}else console.log(STATUS_GENERAL_ERROR)};if("send_sms"==a)var d="phone="+encodeURIComponent(phone_number)+"&deviceType=ac2dm&action=send_sms&action_data="+encodeURIComponent(b);else"mark_single_message_read"==a?(d="deviceType=ac2dm&action=mark_single_message_read&action_data="+encodeURIComponent(b),console.log(d)):"mark_whole_thread_read"==a&&(d="deviceType=ac2dm&action=mark_whole_thread_read&action_data="+
encodeURIComponent(b));c.send(d)}function _f7d2d0c3d299e55e2206ec0f86714bfff8a83935a07edef1babfc35a96daa8a5954b6774c9b4fe98(a){$.ajax({type:"GET",url:"https://accounts.google.com/latitude/mobile_phone-16.gif",cache:!1,success:function(){a()}})}
function _69d14067a79160751977b9a7ce012138717203098b1c3aa0234bcd02351d0ff71fc6bb855aba7d23(a){a||(a=1);_23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b("Entering function CheckGoogleLoginTokenAndSetUserName");$().ajaxError(function(a,b,e){_23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b("AJAX error calling URL: "+e.url+"... Reponse is: "+b.responseText);-1<e.url.search("getUserInfoFull")&&-1<b.responseText.search("500 Server Error")&&
(_23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b("Texty trying to get Full User Auth info for this user (GetUserInfoFull)...and got Error Code 500 - likely case 1 is they are not set up Beta..."),a='<img  align=BOTTOM src="error_icon.png" width=20 height=18 /> <span style="color:black;font-size:12px"> This Google user is not registered for MightyText. Make sure you have completed the full signup process on the MightyText Android App and were invited to the beta.</span>  <a href="#" onclick="window.close();chrome.tabs.create({url: \''+
signOutUrl+'\'})"> Sign out now</a>, or <a href="#" onclick="window.close();chrome.tabs.create({url:\'http://mightytext.net/beta\'})"> Sign up for the beta</a>',window.localStorage.userRegistrationStatus=-1,document.getElementById("top-notif-bar").innerHTML=a);-1<b.responseText.search("500 Server Error")&&(_23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b("Texty trying to get Full User Auth info for this user (GetUserInfoFull)...and got Error Code 500 - likely case 2 is they are not set up Beta..."),
a='<img  align=BOTTOM src="error_icon.png" width=20 height=18 /> <span style="color:black;font-size:12px"> This Google user is not registered for MightyText. Make sure you have completed the full signup process on the MightyText Android App and were invited to the beta.</span>  <a href="#" onclick="window.close();chrome.tabs.create({url: \''+signOutUrl+'\'})"> Sign out now</a>, or <a href="#" onclick="window.close();chrome.tabs.create({url:\'http://mightytext.net/beta\'})"> Sign up for the beta</a>',
document.getElementById("top-notif-bar").innerHTML=a)});$.ajaxSetup({error:function(a,b){console.error(a);console.error(b);if(0==a.status)console.error("*** AJAX REQUEST FAIL -- NETWORK CONNECTION PROBLEM? ***"),_3b0a65b2762a720f13071fc19d875c5b11736a35b4c6415dbd9336d9979899193072fe9e0b9314b6(!1),num_consecutive_internet_connection_failures+=1,_23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b("Number of consecutive internet connection failures: "+num_consecutive_internet_connection_failures),
1==num_consecutive_internet_connection_failures&&(network_connection_status=!1);else if(404==a.status)_23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b("Error 404. Requested URL not found."),document.getElementById("msg").innerHTML="Error 404. Requested URL not found. Showing Local Messages only.";else if(500==a.status){extra_login_status_info="USER_NOT_REG_BETA";_23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b("Error: 500 - Texty trying to get Full User Auth info for this user (GetUserInfoFull)...and got Error Code 500 - likely case 3 is they are not set up Beta...");
var e='<img  align=BOTTOM src="error_icon.png" width=20 height=18 /> <span style="color:black;font-size:14px"> This user is not registered for MightyText. Make sure you have been invited (by e-mail) to the private beta,  and have completed the full signup process on the MightyText Android App.</span>  <a href="#" onclick="window.close();chrome.tabs.create({url: \''+signOutUrl+'\'})"> Sign out now</a>, or <a href="#" onclick="window.close();chrome.tabs.create({url:\'http://mightytext.net/beta\'})"> Sign up for the beta</a>';
document.getElementById("top-notif-bar").innerHTML=e}else"parsererror"==b?(_23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b("Error. Parsing JSON Request failed."),console.log(b),console.log(a)):"timeout"==b?_23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b("Request Time out."):_23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b("Unknown Error:"+a.status);_23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b("Response text returned from server is: "+
a.responseText)}});var b=baseUrl+"/api?function=getUserInfoFull&CLIENT=CRX";_23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b("Inside checkGoogleLoginToken function");$.ajax({url:b,global:!1,type:"GET",timeout:11E3,dataType:"jsonp",jsonpCallback:"getTheUserInfoProfile",error:function(c,b,e){console.log("ERROR in AJAX in getUserInfoFull: "+e);1==a?window.setTimeout(function(){_69d14067a79160751977b9a7ce012138717203098b1c3aa0234bcd02351d0ff71fc6bb855aba7d23(999)},6E3):
999==a&&(console.log("retry attempt 999 (sentinel val)"),_f7d2d0c3d299e55e2206ec0f86714bfff8a83935a07edef1babfc35a96daa8a5954b6774c9b4fe98(_6f7d39edeb231fae5cd42be4b9ba562efe34cc86a8869a0a430be08287d5d89db4e2b1524d81c2f9))},success:function(a){console.log(a);network_connection_status=!0;time_last_success_mighty_ping=new Date;_23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b("Response from Google Login Token check: "+a);if(a.user&&-1<a.user.search("user not logged in")){if(_gaq.push(["_trackEvent",
"CRX-Background","Error","User-Not-Logged-In-CRX",1]),console.error("No Google Account user logged in."),_3b0a65b2762a720f13071fc19d875c5b11736a35b4c6415dbd9336d9979899193072fe9e0b9314b6(!1),login_and_beta_ready=google_login_status=!1,extra_login_status_info=google_username_currently_logged_in="",console.log("url is "+signInUrlCRX),console.log(chrome.extension.getURL("error_icon.png")),0==total_aggregate_polls||80==total_aggregate_polls||150==total_aggregate_polls)a=window.webkitNotifications.createNotification("error_icon.png",
"MightyText - Not Signed In"," You won't be able to send/receive messages. Click here to sign in."),a.ondisplay=function(a){setTimeout(function(){a.currentTarget.cancel()},8E3)},a.onclick=function(){window.open(signInUrlCRX);this.cancel()},a.show(),total_aggregate_polls++}else{if(a.user_info_full&&0<a.user_info_full.email.length){jQuery.parseJSON(a);google_username_currently_logged_in=a.user_info_full.email;window.localStorage.lastKnownGoogleUserName=a.user_info_full.email;_kmq.push(["identify",google_username_currently_logged_in]);
_kmq.push(["record","User Logged In",{"CRX-Login":"true",Client:"CRX"}]);var b=a.user_info_full.ts_creation;if(void 0!=a.user_info_full.channelapi_enabled&&100==a.user_info_full.channelapi_enabled){_3b0a65b2762a720f13071fc19d875c5b11736a35b4c6415dbd9336d9979899193072fe9e0b9314b6(!0);_27291f605844416b650158f21f9359a0bfca14bc707ae6b63b01b74f174255b875d123bce89929a7();_bb1e1760e475e393ed13039e71e03157e7ad6d5f2b4a56703e039e1d97f6e50b882f38d1ed717c0d("REG-OK");clearInterval(currentGlobalIntervalID);console.log("User is NOT a legacy extension user - so no more polling whatsoever!");
_23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b("!!!!!!!! ChannelAPI enabled flag (used for webapp beta testing flag) is : "+a.user_info_full.channelapi_enabled);google_login_status=!0;login_and_beta_ready=!1;google_username_currently_logged_in=a.user_info_full.email;extra_login_status_info="WEBAPP_BETA";username_prefix_jstrg_purpose=a.user_info_full.email.substr(0,a.user_info_full.email.indexOf("@"));_gaq.push(["_trackEvent","Background","CRX-Startup-WEBAPP","",
1]);console.log("******** calling webapp code");clearInterval(globalHeartbeatInterval);globalHeartbeatInterval=setInterval(_01c8936ab33d646acb193455a4966b6c501444a27e338861f7b1e8ecfa7b057c6f9ffdd7b1852164,2E4);_464cdd91c81952d73c2501ec3c9f04c7cfdbeb5f258c4166c79f4383075d5dc08ded0c1424fec689();$.getScript("https://mightytext.net/prod-assets/crx-support.js",function(a,b,c){console.log(a);console.log(b);console.log(c.status);console.log("Load was performed.");processHostedInstructions()});_b911a8f908d97670943721e7f5d50b232e583a11cd58fb308d0118ea4108da526d8f345e65590205();
clearInterval(globalIntervalGetPhoneStatus);globalIntervalGetPhoneStatus=setInterval(_b911a8f908d97670943721e7f5d50b232e583a11cd58fb308d0118ea4108da526d8f345e65590205,24E4);_3d9044241c2bc23be408c12774cc9ff3fe8a39ea77ee5811f2dade91ac23b3b4312171caabc2eca2(google_username_currently_logged_in,a);_f687f97afb66e01bfe2dbb95a0c7177143d0e2ebcd5198f9daf6a668424aea5534f74baf343f4759(google_username_currently_logged_in,b,a.user_info_full.current_app_version,a.user_info_full.ts_last_login,"CRX-MODERN-USER");
capi_rollout_factor=4.5;return}_bb1e1760e475e393ed13039e71e03157e7ad6d5f2b4a56703e039e1d97f6e50b882f38d1ed717c0d("Legacy-CRX-User-SWITCH");console.log("********* LEGACY CRX USER *********");_gaq.push(["_trackEvent","Background","CRX-Startup-LEGACY-SWITCHING","",1]);_f687f97afb66e01bfe2dbb95a0c7177143d0e2ebcd5198f9daf6a668424aea5534f74baf343f4759(google_username_currently_logged_in,b,a.user_info_full.current_app_version,a.user_info_full.ts_last_login,"CRX-LEGACY-OLD");chrome.tabs.create({url:"https://mightytext.net/app/#v1"});
alert("Switching you to the new MightyText Web App. \r\n \r\n Please make sure you have the latest MightyText Android App on your phone (v 3.55) \r\n \r\n Please keep the Chrome Extension installed to receive notifications for incoming SMS.");return!1}-1!=a.user_status.search("not registered")?(_bb1e1760e475e393ed13039e71e03157e7ad6d5f2b4a56703e039e1d97f6e50b882f38d1ed717c0d("NOT-REG"),google_login_status=!0,login_and_beta_ready=!1,google_username_currently_logged_in="",extra_login_status_info="USER_REG_BUT_NO_ACTIVE_ANDROID_REG",
_23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b("This user does not have an active Android App registration! (either never set up or they disconnected..)"),notify_android_app_install_once||(a=webkitNotifications.createNotification("error_icon.png","MightyText - Install Android App ","It looks like you haven't installed the MightyText app on your Android phone. You'll need to first install it on your Android phone using Google Play, and select this same Google account ("+
a.email+").  Click here for full instructions."),capi_rollout_factor=7,a.show(),a.onclick=function(){window.open("http://mightytext.net/install");this.cancel()},notify_android_app_install_once=!0)):(console.log(a.user_status.search("not reg")),notification_general_error_global=webkitNotifications.createNotification("error_icon.png","MightyText","General Error. Please contact the MightyText team."),notification_general_error_global.show())}_23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b("Google Login Status - based on OPENID token from Google: "+
google_login_status+" / username is: "+google_username_currently_logged_in)}})}(function(a){a.getScriptCacheTrueOverrideCustom=function(b,c){a.ajax({type:"GET",url:b,success:c,dataType:"jsonp",cache:!0})}})(jQuery);function _bb1e1760e475e393ed13039e71e03157e7ad6d5f2b4a56703e039e1d97f6e50b882f38d1ed717c0d(a){2>Math.floor(40*Math.random())&&_kmq.push(["record","CRX-UserState-"+a])}
function _b5766940bbb469e2e497da1325f61c7bded309d3d6f6678f37fa7c3377c2393612a025f092b880d9(a){var b=document.getElementsByTagName("head")[0],c=document.createElement("script");c.type="text/javascript";c.onload=_3d9044241c2bc23be408c12774cc9ff3fe8a39ea77ee5811f2dade91ac23b3b4312171caabc2eca2;c.src=a;b.appendChild(c)}
function _892fa92cec69aec15ea0c9e614fa4b2f49b8f7690fd4b9d34056e1e3c3d54c3afddf52166d61d093(){webkitNotifications.createNotification("img/mightytext_square_logo_48px.png","MightyText - Switch to New Web App","Hi - please upgrade to our new web app by February 25th. You should still keep the MightyText Chrome Extension installed for incoming SMS and calls notifications. If you don't switch by February 25th, you will be automatically switched over. The new version is much more stable and has many new features.  Thanks.").show()}
function _b1934eb932d57ceed8cc185912cf90e750b27bfbaa369fbc9e6d179a47ca8e905687a0b4db1a05a0(a){var b=document.createElement("script");b.type="text/javascript";b.async=!0;b.src=a;a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(b,a)}
function _f687f97afb66e01bfe2dbb95a0c7177143d0e2ebcd5198f9daf6a668424aea5534f74baf343f4759(a,b,c,d,e){b=Math.round((new Date(b)).getTime()/1E3);d=Math.round((new Date(d)).getTime()/1E3);intercomSettings={email:a,created_at:b,app_id:"7guo5kws",web_app:e,phone_app_version:c,ts_last_login_at:d,wagda:"27-Jan"};a=function(){var a=f.createElement("script");a.type="text/javascript";a.async=!0;a.src="https://api.intercom.io/api/js/library.js";var b=f.getElementsByTagName("script")[0];b.parentNode.insertBefore(a,
b)};c=window;var f=document,g=function(){g.c(arguments)};g.q=[];g.c=function(a){g.q.push(a)};c.Intercom=g;a();c.attachEvent?c.attachEvent("onload",a):c.addEventListener("load",a,!1)}function _1c3bb13da878f0838fa0f0382e54f3bda9dd0c12b2b18654ea0c257e14ef0bf7fe4a63a346b42547(){should_get_contacts_token_in_new_tab=!1;window.setTimeout(function(){_6d3fd5861333f0e7a869b9df63477e5bd1b6a239d6713c0203528addbbf93f7093e0a2c232b33178()},10)}
function _3d7013ecd340ba44ef2cdd5fe56fc75232320b66a4e2acbacc12257163e4905d14d56e5489a3921d(a){var b=baseUrl+"/getJson?function=GetMessage";$.ajaxSetup({error:function(a,b){if(0==a.status){if(num_consecutive_internet_connection_failures+=1,_23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b("Number of consecutive internet connection failures: "+num_consecutive_internet_connection_failures),3==num_consecutive_internet_connection_failures||15==num_consecutive_internet_connection_failures)network_connection_status=
!1,_3b0a65b2762a720f13071fc19d875c5b11736a35b4c6415dbd9336d9979899193072fe9e0b9314b6(!1)}else 404==a.status?(_23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b("Error 404. Requested URL not found."),document.getElementById("msg").innerHTML="Error 404. Requested URL not found."):500==a.status?(_23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b("Error 500. Internal Server Error."),document.getElementById("msg").innerHTML="Error 500. Internal Server Error."):
"parsererror"==b?_23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b("Error. Parsing JSON Request failed."):"timeout"==b?_23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b("Request Time out."):_23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b("Unknown Error");_23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b("Response text returned from server is: "+a.responseText)}});$.get(b,
{},function(b){network_connection_status=!0;time_last_success_mighty_ping=new Date;num_consecutive_internet_connection_failures=0;_23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b("JSON Raw text response from GetMessage function is: "+b);if(0<b.search("not logged in"))_23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b("User NOT logged in to MightyText"),a&&(google_login_status=!1,google_username_currently_logged_in="");else if('{"messages":}'==
b)console.log("BLANK - no messages");else if(0<b.length){_3b0a65b2762a720f13071fc19d875c5b11736a35b4c6415dbd9336d9979899193072fe9e0b9314b6(!0);var d=JSON.parse(b),e=0,f=0,g=0,f=b.split('"type":"0","source":"0"').length-1;console.log("*** Number of Inbox (incoming msgs), based on string match splits is: "+f);var k=!1;b=!1;6<f&&(k=!0,_23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b("TOO Many messages retrieved in JSON - so don't show any notifs. Total num messages retrieved (incoming only: "+
f),b=!0);$.each(d.messages,function(b,c){var d=c.orig_address,f="",h="";for(a&&_07e9caa5baaf30fdb44691d7d12418bd0acf53a75427674f55437297c338deadbb57ec839b5a6ddd("Found at least 1 Message or ACK/etc, decrease polling frequency",9E3);-1<d.search("[-]");)d=d.replace("-","");-1==d.search("[+]")&&(h="1"==d.charAt(0)?"+":"+1");OLD_phonenum_normalized=h+d;f=c.orig_address;_23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b("found message to sync... "+f+": "+c.body);0==c.status&&
2==c.source?(_157afd78c9f7a7a066130335026da93c7159c2553559285b91564a71d1f8a0087c4961639b83cbbd(c.email,c.body,f,c.android_uid),e++):db.transaction(function(b){b.executeSql("INSERT INTO Messages (googleusername,msgid,time_client,time_server,from_phone_num,body,type,status,source) VALUES (?,?,?,?,?,?,?,?,?)",[c.email,c.android_uid,_3da4048ffc556b9d6c7ae43f64d7eed7675ef9843b38b789da2f768c8e9ad5c498ca6be82ff9febd(c.ts),_3da4048ffc556b9d6c7ae43f64d7eed7675ef9843b38b789da2f768c8e9ad5c498ca6be82ff9febd(c.ts_server),
f,c.body,c.type,c.status,c.source],function(){_d9a4e7e2e1b0a1bd320cf1225c716c6a78b34ad0df518c2e0702a3bec12b032911d3090d9bfef76c(c.android_uid);var b=!1;(0==c.type||81==c.type||80==c.type)&&!1==k?(_23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b("called from BG page and MsgType=0, and not too many messages, so popping single notif now"),b=!0,which_phone_num_for_notif=f):(_23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b("MsgType=1 (sync sent SMS from phone), so don't pop notif"),
g++);if(a){var d=new Date(c.ts),e=new Date,h=e.getTime()-d.getTime(),j=1;81==c.type?j=0.1:80==c.type&&(j=0.005);h>36E5*j&&(b=!1,_23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b("** Message is too old to pop Notif** - for message type: "+c.type));_23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b("...JS date is "+d);_23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b("current time is"+e);_23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b("TIME DIFF (in ms) IS -- "+
h+"ms since msg was sent -- comparing to: "+36E5*j);b&&(b="popup_one_text_message.html#"+c.android_uid,d=webkitNotifications.createHTMLNotification(chrome.extension.getURL(b)),_23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b("showing notif to user...URL is: "+b),_23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b("Notif Level Preference from Local datastore is: "+window.localStorage.notifLevel),d.ondisplay=function(){setTimeout("notification_html.cancel();",
5E3)},d.show(),msgcount="")}},function(a,b){_4a0391f72a976a2c9cd944183f0c285736423751039479c0dfd5ce1d9e9d98cd21f3eb762309b06d(a,b,c.android_uid)})})});b&&(_23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b("showing GENERIC (too many messages) notif to user..."),b=webkitNotifications.createNotification("",f+" Text Messages","You've received "+f+" text messages since the last time you used MightyText, so we won't show you each popup for these messages."),_gaq.push(["_trackEvent",
"Background","Lots-Of-Incoming-Messages-Trigger-Popup","TOO-MANY-NOTIF-"+google_username_currently_logged_in,f]),b.show());_23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b("msg_count_ack is "+e);_23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b("msg_count_incoming is "+f);_23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b("msg_count_outgoing_sync_from_phone is "+g);d=d.messages.length;_23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b("Num messages pulled from this JSON feed is: "+
d);0<d&&(f="",f=a?"Background":"Popup",1<d?_gaq.push(["_trackEvent",f,"Got-Messages-SMS","Got-Multiple-Messages",d]):_gaq.push(["_trackEvent",f,"Got-Messages-SMS","Got-1-Message",d]))}})}
function _157afd78c9f7a7a066130335026da93c7159c2553559285b91564a71d1f8a0087c4961639b83cbbd(a,b,c,d){_gaq.push(["_trackEvent","Background","Got-Message-ACK","",1]);_23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b("Reconciling SMS where originally sent from chrome...");db.transaction(function(e){_23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b("UPDATE Messages SET status=52 WHERE googleusername="+a+"and body="+b+" and from_phone_num="+
c+"  and status=51");e.executeSql("UPDATE Messages SET status=52 WHERE googleusername=? and body=? and from_phone_num=? and status=51",[a,b,c],function(){_d9a4e7e2e1b0a1bd320cf1225c716c6a78b34ad0df518c2e0702a3bec12b032911d3090d9bfef76c(d)},_1ab5a1b8b5e15644f372cb5ea3114befc07a8b7d8351a2027976ef549f0fc2416068f1b883b3824e)})}
function _4a0391f72a976a2c9cd944183f0c285736423751039479c0dfd5ce1d9e9d98cd21f3eb762309b06d(a,b,c){_23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b("SQL insert error: "+b.message);-1<b.message.search("constraint failed")&&(_23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b("because it IS a constraint message, we will now RETRY to delete message on server, with android_uid "+c+" from the Cloud Server"),_d9a4e7e2e1b0a1bd320cf1225c716c6a78b34ad0df518c2e0702a3bec12b032911d3090d9bfef76c(c))}
function _d9a4e7e2e1b0a1bd320cf1225c716c6a78b34ad0df518c2e0702a3bec12b032911d3090d9bfef76c(a){var b=baseUrl+"/getJson?function=DeleteMessages&android_uid="+a;_23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b("Attempting to delete from cloud server this android_uid:"+a);$.ajax({type:"GET",url:b,success:function(a){_23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b("Response from cloud after delete attempt: "+a)},error:function(){console.log("error in deletemessagefrom server")}})}
var globalWidgetNotifTester;function _1ac0b9125cbf6a37703d7669547a93b2ebd3b6457d4b07f29cf7a21bbb3f6b83a6d1659a197f245f(){globalWidgetNotifTester=webkitNotifications.createHTMLNotification("mighty-widget.html");globalWidgetNotifTester.show()}
function _0f2980b9da943955552c0badec8dd3e8ae6765ce84852dbc90b9261ba5f8af526f64a8f28d9a3e5b(){_23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b("Getting channel API token...");$.ajax({type:"GET",url:baseUrl+"/getJson?function=getChannelToken&mins=240",success:function(a){console.log("Response from cloud after channel attempt (should have valid_token prepend): "+a);if(0>a.search("valid_token:"))console.log("No valid_token prepend found from Channel API!");else{time_last_channel_token_obtained=
new Date;console.log("Resetting Last Channel ATTEMPT TO OBTAIN Token time . . .");a=a.replace("valid_token:","");var b=(new goog.appengine.Channel(a)).open();console.log("calling channel.open");b.onopen=function(){console.log("Socket Opened via Channel API with token: "+a);_gaq.push(["_trackEvent","Background","ChannelAPI-Open-Socket","",1])};b.onmessage=function(a){_216b0f8f081043b4920a254bbb54286081e2cf09987c951a467e836ca99990d38be51ad35d623e5a();_gaq.push(["_trackEvent","Background","ChannelAPI-Message-Received",
"",1]);console.log("**** CHANNEL SOCKET ONMESSAGE *** Force a poll... ");console.log("Message arrived via channel API= "+a.data)};b.onerror=function(){console.log("!!!!!!!!!!!!! TOKEN GONE (via onerror callback)!!!!!!!!!!!!");_gaq.push(["_trackEvent","Background","ChannelAPI-Socket-ONERROR-Token-Expired","",1]);_0f2980b9da943955552c0badec8dd3e8ae6765ce84852dbc90b9261ba5f8af526f64a8f28d9a3e5b()};b.onclose=function(){console.log("!!!!!!!!!!!!! TOKEN GONE (via onclose callback) !!!!!!!!!!!!");_gaq.push(["_trackEvent",
"Background","ChannelAPI-Socket-ONCLOSE","",1])}}}})}function _8f21e855ff9dc489d86fb0e9fcc4a391d007dd33a06c84660420481a692addd0d1443b753b2b6ca6(a){webkitNotifications.createNotification("",Date(),a).show()}
function _4a2043322e1f7b961aabb724d3d23c9207623898d79b5f711b7c84ceafdaa9ab94a3de9a452234ec(){var a="popup_one_text_message.html#"+thismessage.android_uid,b=webkitNotifications.createHTMLNotification(chrome.extension.getURL(a));_23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b("showing notif to user...URL is: "+a);_23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b("Notif Level Preference from Local datastore is: "+window.localStorage.notifLevel);
b.show()}function _7869f2afc0158af85f593bc60124e314d9a1d58c4fc535ff885e31d70f5cd2c4c14b396ddae3ef78(a){chrome.windows.create({url:a,left:10,top:10,width:810,height:610,type:"popup"},function(){})}
function _3da4048ffc556b9d6c7ae43f64d7eed7675ef9843b38b789da2f768c8e9ad5c498ca6be82ff9febd(a){var b=new Date(a);a=b.getHours();var c=b.getSeconds(),d=b.getMinutes(),e=b.getDate(),f=b.getMonth(),b=b.getFullYear();f++;10>f&&(f="0"+f);10>e&&(e="0"+e);10>a&&(a="0"+a);10>d&&(d="0"+d);10>c&&(c="0"+c);return b+"-"+f+"-"+e+" "+a+":"+d+":"+c}var should_get_contacts_token_in_new_tab=!1;
function _6d3fd5861333f0e7a869b9df63477e5bd1b6a239d6713c0203528addbbf93f7093e0a2c232b33178(){oauth.authorize(function(){_23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b("on google contacts - oauth.authorize()");oauth.sendSignedRequest("http://www.google.com/m8/feeds/contacts/default/full",_b1ff83a6024e50ccbb732f5b85745b0867acd3c09879d284197965980b2d4432db5dcc29931d3cb0,{parameters:{alt:"json","max-results":1E4}})})}
function _fbb80e8aa6ec05cc71f898d7dcf92deafb75954f810bd2adca8109e71a0fa4995bb7a965fd8d905a(){oauth.clearTokens()}function _17a164d38dc4cd1d2744541946a212289f492e849f26a7e30c11faa76d3172144c94f8d0bb891cf6(){window.localStorage.notifLevel=3}
function _3a5c6e75a23a68a0a08e68245dab4f92e034e9f41d23432b4c66cf0eea9abc6df51f6223ca671ed7(){db||(db=openDatabase("Texty","1.0","Texty-SMS",2E5));db.transaction(function(a){a.executeSql("SELECT COUNT(*) as cnt FROM sqlite_master where name='Messages'",[],function(a,c){var d=c.rows.item(0).cnt;_23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b("Messages table exists?: "+d);0==d&&(_23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b("Couldnt find table LocalGoogleContacts...creating..."),
_ebccb1b0caf018a968dabc0324272ab8352b1338d1f2004122e4d0304f225cc2f0edd679b80d863f())},_1ab5a1b8b5e15644f372cb5ea3114befc07a8b7d8351a2027976ef549f0fc2416068f1b883b3824e)});db.transaction(function(a){a.executeSql("SELECT COUNT(*) as cnt FROM sqlite_master where name='LocalGoogleContacts'",[],function(a,c){var d=c.rows.item(0).cnt;_23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b("LocalGoogleContacts table exists?: "+d);0==d&&(_23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b("Couldnt find table LocalGoogleContacts...creating..."),
_199f61ed737b9b686f73117fefa84379585ad7ce05d5b5344d68091739623bb60443f3ab70859cbd())},_1ab5a1b8b5e15644f372cb5ea3114befc07a8b7d8351a2027976ef549f0fc2416068f1b883b3824e)})}
function _ebccb1b0caf018a968dabc0324272ab8352b1338d1f2004122e4d0304f225cc2f0edd679b80d863f(){db.transaction(function(a){a.executeSql("CREATE TABLE Messages (id INTEGER PRIMARY KEY AUTOINCREMENT, googleusername TEXT, msgid TEXT UNIQUE, time_client DATE, time_server DATE, from_phone_num TEXT, body TEXT, type INTEGER, status INTEGER, source INTEGER)",[],function(){_23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b("table Messages created")},_1ab5a1b8b5e15644f372cb5ea3114befc07a8b7d8351a2027976ef549f0fc2416068f1b883b3824e)})}
function _199f61ed737b9b686f73117fefa84379585ad7ce05d5b5344d68091739623bb60443f3ab70859cbd(){db.transaction(function(a){a.executeSql("CREATE TABLE LocalGoogleContacts (id INTEGER PRIMARY KEY AUTOINCREMENT, googleusername TEXT, phone_num TEXT UNIQUE, contact_name TEXT)",[],function(){_23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b("table LocalGoogleContacts created")},_1ab5a1b8b5e15644f372cb5ea3114befc07a8b7d8351a2027976ef549f0fc2416068f1b883b3824e)})}
function _23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b(a){1==debug_mode&&console.log(a)}
function _63edc00dd64912451f2cb6b12f913cf60ed3f57c94f50977cfadb6b1d53fa2fcab084332d424d2b8(a,b){for(var c=0;c<contacts.length;c++){var d=_1190522a55ffda492c5f8e7d977692b124398d32a525a7df3d61c9dd8283a9afef3d5dc770807788(contacts[c].phonenums[0]).search(a);if(-1<d)return _23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b("FOUND substring in Google Contact Array- substring match position is: "+d),_23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b("Inserting this contact into Local Contact DB table...full phone num is "+
b+"..."+contacts[c].name),_04dda587ce5a5e87908547569fa05fb62a2b3ba90c68f757afaca5673ec252d936026b79e337be89(contacts[c].phonenums[0],contacts[c].name),{contactPhoneNumberfromGoogleContactsArray:b,contactNamefromGoogleContactsArray:contacts[c].name}}return""}
function _4f5645f4eb91b42730be27e1029ad446c81d1382b98039782f4f68df506cd143b5015738ff3af2c1(a){for(var b=0;b<localContactsArray.length;b++){var c=_1190522a55ffda492c5f8e7d977692b124398d32a525a7df3d61c9dd8283a9afef3d5dc770807788(localContactsArray[b].phone_num).search(a);if(-1<c)return _23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b("FOUND substring in local contact - substring match position is: "+c),{contactPhoneNumberLocalDB:localContactsArray[b].phone_num,contactNameLocalDB:localContactsArray[b].contact_name}}return""}
function _1190522a55ffda492c5f8e7d977692b124398d32a525a7df3d61c9dd8283a9afef3d5dc770807788(a){for(;-1<a.search("[-]");)a=a.replace("-","");for(;-1<a.search("[ ]");)a=a.replace(" ","");for(;-1<a.search("[(]");)a=a.replace("(","");for(;-1<a.search("[)]");)a=a.replace(")","");7>a.length&&(a=_e1da2a0fda25ee1865940678103797062da7cba55296c37edc970c31de7c9ec1667e4bd363cec4e8(a,7));return a}
function _04dda587ce5a5e87908547569fa05fb62a2b3ba90c68f757afaca5673ec252d936026b79e337be89(a,b){db.transaction(function(c){c.executeSql("INSERT INTO LocalGoogleContacts (googleusername,phone_num,contact_name) VALUES (?,?,?)",[google_username_currently_logged_in,a,b],function(){_23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b("Added Contact to local SQL: "+b+" / "+a+" / "+google_username_currently_logged_in)},_1ab5a1b8b5e15644f372cb5ea3114befc07a8b7d8351a2027976ef549f0fc2416068f1b883b3824e)})}
function _24e700a5aa3f8b177b7b7050c13e61979927d3f8a4d0c932af48f25c7e31c0992f84129918556058(){$.get("http://textyapp.com/get_dynamic_info.php",function(a){dynamic_info_global=a})}function _e1da2a0fda25ee1865940678103797062da7cba55296c37edc970c31de7c9ec1667e4bd363cec4e8(a,b){for(var c=a+"";c.length<b;)c="0"+c;return c}function _049aa165db6223a076237384bec028620b7243d8787d41d9c35c57ef9e4aba799bacefac312149a4(a){return a};