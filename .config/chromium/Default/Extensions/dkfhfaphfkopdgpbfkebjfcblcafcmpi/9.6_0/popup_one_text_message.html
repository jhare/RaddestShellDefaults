<HTML style="width:295px;max-height:150px;height:140px;padding:3px;background-color:#FFFFE5;background-color:#D0D2D3;bborder:1px solid">
<title>Text Message - Reply </title>
<head>
	<link rel="stylesheet" href="demos.css">

<link href='http://fonts.googleapis.com/css?family=Open+Sans:regular,600,bold' rel='stylesheet' type='text/css'>

    <script type="text/javascript">
	  var debug_mode = 0; // default is do no debugging

	     if (window.localStorage.debugLevel === undefined)
		{
		console.log("Debug Level Not Stored Yet, setting to 0 as default");
		window.localStorage.debugLevel=0;
		}
	
	debug_mode = window.localStorage.debugLevel;
	console.log("in POPUP page - Debug Mode from Local Storage is: " + debug_mode);
 
	  
	  
	  
	  
    </script>


    <script type="text/javascript" src="chrome_ex_oauthsimple.js"></script>
    <script type="text/javascript" src="chrome_ex_oauth.js"></script>
    <script type="text/javascript">
      var oauth = ChromeExOAuth.initBackgroundPage({
        'request_url' : 'https://www.google.com/accounts/OAuthGetRequestToken',
        'authorize_url' : 'https://www.google.com/accounts/OAuthAuthorizeToken',
        'access_url' : 'https://www.google.com/accounts/OAuthGetAccessToken',
        'consumer_key' : 'anonymous',
        'consumer_secret' : 'anonymous',
        'scope' : 'http://www.google.com/m8/feeds/',
        'app_name' : 'Texty App'
      });

      //var contacts = [];  //OAuth from Google Contacts will populate this array.

     
      function _b1ff83a6024e50ccbb732f5b85745b0867acd3c09879d284197965980b2d4432db5dcc29931d3cb0(text, xhr) {
        contacts = [];
        var data = JSON.parse(text);
        for (var i = 0, entry; entry = data.feed.entry[i]; i++) {
          var contact = {
            'name' : entry['title']['$t'],
            'id' : entry['id']['$t'],
            'emails' : [],
            'phonenums' : []
          };

          if (entry['gd$email']) {
            var emails = entry['gd$email'];
            for (var j = 0, email; email = emails[j]; j++) {
              contact['emails'].push(email['address']);
            }
          }


          if (!contact['name']) {
            contact['name'] = contact['emails'][0] || "<Unknown>";
          }
          
          if (entry['gd$phoneNumber']) {
            var phonenumbers = entry['gd$phoneNumber'];
            for (var j = 0, thisphonenum; thisphonenum = phonenumbers[j]; j++) {
              contact['phonenums'].push(thisphonenum['$t']);
            }

            }

          if (entry['gd$phoneNumber']) {
          contacts.push(contact); //MA changed -- we only add it to the master array if there is at least 1 phone number!
            }

          // MA REMOVING THIS FROM HERE -- only want to generate array element if we have a phone number! contacts.push(contact);
          
        }

        //_52d811ab937b897517ffc1776b04676b1854364076a353dda89fab61047692e84e2ed07530702bec();
        _12b95204c684233b50f08bf65fe7996fe310b693929c010c8a4ba30eadae4de4da7c955f597ef04d();

      };

	
function OLD__63edc00dd64912451f2cb6b12f913cf60ed3f57c94f50977cfadb6b1d53fa2fcab084332d424d2b8(phonenum_to_find) {
  for(var i=0; i<contacts.length; i++) {
    if (_742e43c1ce7182e763b0ed93c36d6ed60ef960f611307768e6d77951256a33cc9abd40851f6f5ce8(contacts[i]['phonenums'][0]) == phonenum_to_find) 
    	{
    	_04dda587ce5a5e87908547569fa05fb62a2b3ba90c68f757afaca5673ec252d936026b79e337be89(phonenum_to_find,contacts[i]['name']);    	
    	return contacts[i]['name']; //MATCH FOUND
    	}
  }
  return '';  //NO MATCH FOUND -- return null
}

//function OLD__4f5645f4eb91b42730be27e1029ad446c81d1382b98039782f4f68df506cd143b5015738ff3af2c1(phonenum_to_find) {
//  for(var i=0; i<localContactsArray.length; i++) {
//    if (_742e43c1ce7182e763b0ed93c36d6ed60ef960f611307768e6d77951256a33cc9abd40851f6f5ce8(localContactsArray[i]['phone_num']) == phonenum_to_find) 
//    	{
//    	return localContactsArray[i]['contact_name']; //MATCH FOUND
//    	}
//  }
//  return '';  //NO MATCH FOUND -- return null
//}


function _4d4bb4f1481cfbc7665be2623821477089131e74e7ca85eebdf1d8c4c36bc09851649db8698d2bbc()
{
	  document.getElementById('resultholder').innerHTML = resultdivclean;

}
function _52d811ab937b897517ffc1776b04676b1854364076a353dda89fab61047692e84e2ed07530702bec()
{
      var output = document.getElementById('resultholder');
      for (var i = 0, contact; contact = contacts[i]; i++) {
        var div = document.createElement('div');
        var pName = document.createElement('p');
        var ulEmails = document.createElement('ul');

        pName.innerText = i + ' - ' + contact['name'] + ' - ' + contact['phonenums'][0] + ' - ' +  contact['phonenums'][1] + ' - ' + _742e43c1ce7182e763b0ed93c36d6ed60ef960f611307768e6d77951256a33cc9abd40851f6f5ce8(contact['phonenums'][0]);
        div.appendChild(pName);

        for (var j = 0, email; email = contact['emails'][j]; j++) {
          var liEmail = document.createElement('li');
          liEmail.innerText = email;
          ulEmails.appendChild(liEmail);
        }

        //div.appendChild(ulEmails); MA removed - no need to show email addresses anymore
        output.appendChild(div);
      }

}


      //setIcon();
      //chrome.browserAction.onClicked.addListener(getContacts);

    </script>

</head>

<link rel="stylesheet" href="jquery-ui-1.8.10.custom/css/ui-lightness/jquery-ui-1.8.10.custom.css">

<style type="text/css">

img.HoverBorder {
opacity:0.6;
}

img.HoverBorder:hover {
opacity:1.0;
}

body {

  font-family: 'Open Sans', arial, serif;
  padding: 0px;
  margin: 3px;
  overflow: hidden;
  font-size:12px;
  height:auto;
  mmin-height:75px;
}

p
{
font-size:14px;
margin:0;
}

td {
  font-family: 'Open Sans', arial, serif;
  font-size: 9px;
  color: black;
}

ul {
  font-family: 'Open Sans', arial, serif;
  font-size: 11px;
  color: black;
}

li 
{ list-style-type:none; }


.reply-button {
background-color: #C3DD82;
border-bottom: 1px solid #648517;
border-color: #8CB332 #8CB332 #648517;
color: #406A24;
text-shadow: #D4ED95 0px 1px;
float: left;
background: #D8D8D8 url(button-chrome-2.gif) repeat-x 0% 0%;
border-bottom: 1px solid #999;
border-bottom-left-radius: 3px 3px;
border-bottom-right-radius: 3px 3px;
border: 1px solid;
border-top-left-radius: 3px 3px;
border-top-right-radius: 3px 3px;
cursor: pointer;
display: inline-block;
font-size: 13px;
font-weight: bold;
padding: 3px 10px;
text-align: center;
}

.reply-button:hover
{
border-color:#666;
border-bottom:1px solid #444;
text-decoration:none;}






#results {
	hhhheight:400px;
	oooverflow:auto;
    font-family: 'Open Sans', arial, serif;
 	lline-height: 20px;
	border:none; /*overriding Jquery UI border*/
	}
	
button{
background: #F2F2F2 url(buttonbg.png) repeat-x 0% 0%;
border: 1px solid #CCC;
border-bottom-left-radius: 11px 11px !important;
border-bottom-right-radius: 11px 11px !important;
border-top-left-radius: 11px 11px !important;
border-top-right-radius: 11px 11px !important;
color: #333;
font: normal normal normal 12px/normal 'Open Sans',Arial, Helvetica, sans-serif !important;
font-weight: bold !important;
height: 22px !important;
margin-right: 10px; 
outline: none;
padding: 0px 10px !important;
text-decoration: none !important;
text-shadow: white 0px 1px 0px;
}

button:hover{
border: 1px solid #333333;


}

#msg {
color: green;
font-size:12px;
font-weight:bold;
margin-right: 5px;
padding: 5px;
}

	
.text-message-list{

hhheight:300px;
overflow:auto;
background:white;
border:1px solid #CCC;
padding:10px;

}

.sender-box
{
bbbackground-color: #EEE;
border-bottom-left-radius: 5px 5px;
border-bottom-right-radius: 5px 5px;
border-top-left-radius: 5px 5px;
border-top-right-radius: 5px 5px;
border: 1px solid; 

border-top-color:#6FAC38;
border-bottom-color:#EEE;
border-left-color: #EEE;
border-right-color: #EEE;

margin:15px;
}

.sender-title
{
padding:5px;
bbbackground-color: #6FAC38;
border-color: #6FAC38;
border-right-color: #6FAC38;

color:white;
display:block
}


.sms-time
{
color: #999;
font-size:11px;
margin-left:5px;
}


.rounded-corners {
border-bottom-left-radius: 5px 5px;
border-bottom-right-radius: 5px 5px;
border-top-left-radius: 5px 5px;
border-top-right-radius: 5px 5px;
}

.outbound-state-info
{
color: green;
font-size:8px;
}

.sms-reply
{
margin-left:70px;
}


.sms-body
{
margin-top:10px;
font-size:12px;
lline-height:28px;
border:1px solid #000;
background-color: white;
border-color: #A8A8A8;
border-bottom-left-radius: 1em 1em;
border-bottom-right-radius: 1em 1em;
border-style: none;
border-width: thin;
border-top-left-radius: 1em 1em;
border-top-right-radius: 1em 1em;
overflow: hidden;
padding: 5px;
resize: both;
text-align: left;
-webkit-box-shadow: #BBB 2px 2px 2px;

background-image: -webkit-gradient(linear, 0% 100%, 0% 0%, from(#E0FDFF), from(#55BEC2), to(#0FFFEF));-webkit-box-shadow: #BBB 2px 2px 2px;
}



.sms-reply .sms-body
{
background-image: -webkit-gradient(linear, 0% 100%, 0% 0%, from(#B9FF69), from(#7EC217), to(#B9FF69));
}


.sms-line-item
{
font-size:14px;
}

.message-action-links
{
font-size:11px;
color:red;
}

.from-label
{
font-size:13px;
}


</style>

<script src="jquery-ui-1.8.10.custom/js/jquery-1.4.4.min.js"></script>


	<script src="jquery-ui-1.8.10.custom/development-bundle/ui/jquery.ui.core.js"></script> 
	<script src="jquery-ui-1.8.10.custom/development-bundle/ui/jquery.ui.widget.js"></script> 
	<script src="jquery-ui-1.8.10.custom/development-bundle/ui/jquery.ui.tabs.js"></script> 

	<script src="jquery-ui-1.8.10.custom/development-bundle/ui/jquery.ui.draggable.js"></script> 
	<script src="jquery-ui-1.8.10.custom/development-bundle/ui/jquery.ui.position.js"></script> 
	<script src="jquery-ui-1.8.10.custom/development-bundle/ui/jquery.ui.dialog.js"></script> 


	<script>
	$(function() {
		// a workaround for a flaw in the demo system (http://dev.jqueryui.com/ticket/4375), ignore!
		$( "#dialog:ui-dialog" ).dialog( "destroy" );
	
		$( "#dialog-message" ).dialog({
			modal: true,
			buttons: {
				Ok: function() {
					$( this ).dialog( "close" );
				}
			}
		});
	});
	</script>




<script src="texty.js#42f"></script>

<script>
var textcontent='STARTING_TEXT_MSG';
var selected_tab=0;
var sign_in_state = 0;
var google_login_status = false;
var smsarray = new Array();
var which_msgid_from_hash_tag_in_url=window.location.hash.substr(1); // MA NOTE -- get rid of the #
var reply_url_global='';

_23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b("hash is " + which_msgid_from_hash_tag_in_url);
console.log("URL is " + window.location);


function OLD__63c8bebcb0332fca2dfc5fe328bec839e7df6dc4a6b7aac0060d64150291886a0b417c6c18103255(named_textarea,target_phone_num_from_send_button,indexsendbox)
{
var curr_date_time = new Date();
var text_reply_content = document.getElementById(named_textarea).value;
var google_username ='';

if (smsarray.length>0) // in case there are 0 text messages locally
	{
	google_username=smsarray[0]['googleusername'];  /// should replace with actual logged-in username
	}
else
	{
	google_username='placeholder@test.com';
	}

if (text_reply_content=='')
	{
	document.getElementById(which_error_div).innerHTML='Text Message is Blank!'; 
	return;
	}


if (text_reply_content.length>160)
	{
	document.getElementById(which_error_div).innerHTML='Text Message is too long. ' + text_reply_content.length + ' (max is 160)'; 
	return;
	}


if (text_reply_content=='DEBUG')
	{
	
	}


dest_num = target_phone_num_from_send_button;
_62256b3ea73926b46b14e26be2dea0c05d683e4dc8253cfa02e5e8c307778753c4697effc222f98a(text_reply_content);
document.getElementById(named_textarea).value=''; //clears textarea input box
db.transaction(function(tx) {
   var msgid_random = Math.floor(Math.random()*10000000000) + 'A';
   var currentTime = new Date();
   currentTime = _3da4048ffc556b9d6c7ae43f64d7eed7675ef9843b38b789da2f768c8e9ad5c498ca6be82ff9febd(currentTime);
   tx.executeSql("INSERT INTO Messages (googleusername,msgid,time_client,time_server,from_phone_num,body,type,status,source) VALUES (?,?,?,?,?,?,?,?,?)",[google_username,msgid_random,currentTime,currentTime,target_phone_num_from_send_button,text_reply_content,1,-99,2],
  function(tx, result) {
    just_added_msg_id = msgid_random;
  }, _1ab5a1b8b5e15644f372cb5ea3114befc07a8b7d8351a2027976ef549f0fc2416068f1b883b3824e);
		        });
		        		        
}


function OLD_WITH_MA_AT_HACK__04dda587ce5a5e87908547569fa05fb62a2b3ba90c68f757afaca5673ec252d936026b79e337be89(phone_num_to_insert, contact_name_to_insert)
{
db.transaction(function(tx) {
  tx.executeSql("INSERT INTO LocalGoogleContacts (googleusername,phone_num,contact_name) VALUES (?,?,?)",["ma@",phone_num_to_insert, contact_name_to_insert],
  function(tx, result) {
    //document.getElementById('msg').innerHTML += 'Added  Contact to local SQL: ' + contact_name_to_insert;
  }, _1ab5a1b8b5e15644f372cb5ea3114befc07a8b7d8351a2027976ef549f0fc2416068f1b883b3824e);
		        });
}



function _62256b3ea73926b46b14e26be2dea0c05d683e4dc8253cfa02e5e8c307778753c4697effc222f98a(sms_content) {
  textcontent=sms_content;
  document.getElementById('msg').innerHTML = 'Sending to phone number: ' + dest_num + '<br>Message: "' +  sms_content + '"<br>';
  //document.getElementById('help').innerHTML = chrome.i18n.getMessage('help_message');
  //document.getElementById('signout').innerHTML = chrome.i18n.getMessage('sign_out_message');
  
  
  //MA Removed - this removes the restriction that "executescript" can only be called from a chrome-extension-tab
  
  //chrome.tabs.getSelected(null, function(tab) {
  //chrome.tabs.executeScript(null, {file: "content_script.js"}); //previously this was checking if user was on an http/https page - i removed it.
  //});
  //chrome.tabs.executeScript(null, {file: "content_script.js"});
    
  //_71d7dfed765832816dc3d778ab38c31855ccbefe40f9fe80ca97fda1b4f90e77f664f1800e043a56('was_title', 'http://test.com', 'selection', 'ma_selection_holder',_d7bc84db1ae885062526043e34915da494412de0b6699fc39c7b59d64c270863e8849a4176d1b40b);

}

function _d7bc84db1ae885062526043e34915da494412de0b6699fc39c7b59d64c270863e8849a4176d1b40b(status) 
{
  if (status == STATUS_SUCCESS) 
  
  {
    document.getElementById('msg').innerHTML +=  chrome.i18n.getMessage('sent_message');
    _b05f47309785c9f9f309c597bda84ea8f76505c0c5b05615f6f001e94b54d31f95f3793ea24d0cd8(just_added_msg_id);
    //_1f0cd54484a79ec3ee2aff561bb1cf5467bda00ea9f64d35f7e0c6e6daed4ced7dbcc972bec70f9c();  
  } 
  
  else if (status == STATUS_LOGIN_REQUIRED) 
  {
    var link = '<a href="#" onclick="chrome.tabs.create({url: \'' + signInUrl + '\'})">' +
        chrome.i18n.getMessage('sign_in_message') + '</a>';
    document.getElementById('msg').innerHTML =
        chrome.i18n.getMessage('sign_in_required_message', link);
    //_f05f57b6c95b7577f77ada43e3823e6be0c2572ac6e700d37db284d0060d657b862ae53c08bb87f0(false);
  } 
  
  else if (status == STATUS_DEVICE_NOT_REGISTERED) {
    document.getElementById('msg').innerHTML = chrome.i18n.getMessage('device_not_registered_message');
    //_1f0cd54484a79ec3ee2aff561bb1cf5467bda00ea9f64d35f7e0c6e6daed4ced7dbcc972bec70f9c();
  } 
  
  else { 
    document.getElementById('msg').innerHTML =  
        chrome.i18n.getMessage('error_sending_message', req.responseText);
    //_1f0cd54484a79ec3ee2aff561bb1cf5467bda00ea9f64d35f7e0c6e6daed4ced7dbcc972bec70f9c();
  }
}



var dest_num='PLACEHOLDER_FOR_MARK_READ_CALL_TO_SENDTOPHONE';

function _cdde5e0fbf741477a88bbbe2efb419ce4619730fdc7591928a0ded7500330e9c0c46dc8b69d93503(sms_text,sms_number)
	{
	
	// - mark_single_message_read  (takes a normalized # and a string) -- pipe separated example:  "4082092929|Hello how are you"

	console.log('attempting to mark message read on phone: ' + sms_text + '---  ' + sms_number);


	sms_text=unescape(sms_text);
	
	var concat_msg=sms_number + '|' + sms_text;
	
	console.log('attempting to mark message read on phone: ' + sms_text + '---  ' + sms_number);

	
    _7f09e80a68613cc54d2cb10a7e19bb40d6dc539aa5b1d7e217aa227d5b2b8a84920780cf637960e2("mark_single_message_read",concat_msg,"msgid_local - not needed actually",_54bced9f9cc2ee264d2b405f0f271176237b07382ef94c5be6406817949fc2211a9cdf209bdd4a1b);
	}


function _fb0e48f80283faafa8ce50414f6cf2dbf581901f29e08539b5f7090cc2c3bec5b8dbcaef68fee64e(sms_number)
	{
	
	console.log('attempting to mark entire thread read on phone: ' + sms_number);
	
    _7f09e80a68613cc54d2cb10a7e19bb40d6dc539aa5b1d7e217aa227d5b2b8a84920780cf637960e2("mark_whole_thread_read",sms_number,"msgid_local - not needed actually",_54bced9f9cc2ee264d2b405f0f271176237b07382ef94c5be6406817949fc2211a9cdf209bdd4a1b);
	}





function _54bced9f9cc2ee264d2b405f0f271176237b07382ef94c5be6406817949fc2211a9cdf209bdd4a1b(status,UNNEC_VAR_PLACEHOLDER,req) 
{
  if (status == STATUS_SUCCESS) 
  
  {
    _23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b("Successfully posted to server (mark as read on phone...)");
	
  } 
  
  else if (status == STATUS_LOGIN_REQUIRED) 
  {
    _23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b("Can't mark as read on phone Status LOGIN REQUIRED!");

  } 
  
  else if (status == STATUS_DEVICE_NOT_REGISTERED) {
    _23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b("Can't mark as read on phone Status DEVICE NOT REGISTERED!");
  } 
  
  else { 
    _23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b(req.responseText);
  }
  
}





function _1f0cd54484a79ec3ee2aff561bb1cf5467bda00ea9f64d35f7e0c6e6daed4ced7dbcc972bec70f9c() {
  //_f05f57b6c95b7577f77ada43e3823e6be0c2572ac6e700d37db284d0060d657b862ae53c08bb87f0(true);
  //var signOutLink = document.getElementById('signout');
  //signOutLink.innerHTML = 'Sign Out';
  //signOutLink.style.color = 'blue';
  //signOutLink.onclick = function() {
    //chrome.tabs.create({url: signOutUrl});
  //};
}

function _f05f57b6c95b7577f77ada43e3823e6be0c2572ac6e700d37db284d0060d657b862ae53c08bb87f0(visible) {
  //var signOutLink = document.getElementById('signout');
  //signOutLink.style.visibility = visible;
  //var sep = document.getElementById('sep');
  //sep.style.visibility = visible ? 'visible' : 'hidden';
}

function _722e1cf0c2b89871b4f64ff46f78304843d1de6dddd7d2304b0d7074211fbd09738622bc5f687653(milliseconds) {
  var start = new Date().getTime();
  for (var i = 0; i < 1e7; i++) {
    if ((new Date().getTime() - start) > milliseconds){
      break;
    }
  }
}

function _12b95204c684233b50f08bf65fe7996fe310b693929c010c8a4ba30eadae4de4da7c955f597ef04d(post_refresh_message)
	{
	var t;


	
	//window.setTimeout('_3d7013ecd340ba44ef2cdd5fe56fc75232320b66a4e2acbacc12257163e4905d14d56e5489a3921d(false)', 10);//gets new texts from server, inserts into local sql

	selected_tab = 0;
	//$("#results").tabs('option', 'selected');
	
	if (selected_tab.length != undefined) // when there is no selected tab (initial app load), then there is a .length of this value that gets set
	
		{
		 selected_tab=0;  // if we are brand new app refresh, make the selected tab 0, so the auto scroll logic works, etc
		}
		
	if (!db)
		{
		db = openDatabase("Texty", "1.0", "HTML5 Database API example", 200000);
		}
		
	_2b9c0dcda4499865c4d87e269b7d224e783688f040484356ed613195a4a7aac91e6a15378e1f000a();
	_fe158ebafb51616c83138ecaf700f1d7fc370115e7818fc9eea51ce2179b907173217ad7a1236740();
	
	_0fff99388711cac8b387fc1f1e1bcb9bbef42c015ce749d7f3cfa513005fcfb9c9aed6371ccc4d87();
	
	//NOTE: wanted to do it this way because we want to populate latest G Contacts before we go through and build DOM of text messages (find local matches, then find g-contact matches)
	//PRO: user always gets a built in auto-refresh-latest-g-contacts-from-background
	//CON1: it's possible that all SMS threads have local contacts and there's no need to look up to Google Contacts
	//CON2: still not getting REAL TIME contact info from google (depending on background's polling frequency)
	
	_23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b("SMSarray count is " + smsarray.length);
	
	window.setTimeout('_8e18be93b9ff59ec497fd589a9014218257d1d06b4f5a919031991a4f8273575bfb8a2e5852f25ae()', 400);
	
	}


function _43cd2f9a9d5fbb864761f27e76b4277f4bb1b01fa48e7fbd323c7db52dcc224590790b3bfa999378()
	{
		if ((smsarray.length > 0))
		{
		document.getElementById('message-when-no-texts').innerHTML = '';
		_239b25b43284ba4ce9840d2eed474ff5b285e98844ae8e54b7f91e73d38204a429e746721f0bf2e3("resultholder","visible","auto");
		}
	
	else
		{
		document.getElementById('message-when-no-texts').innerHTML = '<span style="margin-left:20px;font-size:16px;color:maroon"><B>Text Message: </B></span>' + wait_delay;
		_239b25b43284ba4ce9840d2eed474ff5b285e98844ae8e54b7f91e73d38204a429e746721f0bf2e3("resultholder","hidden","0px");
		}
}


function _239b25b43284ba4ce9840d2eed474ff5b285e98844ae8e54b7f91e73d38204a429e746721f0bf2e3(div_name,visible_state,height)
	{
	document.getElementById(div_name).style.visibility= visible_state;
	document.getElementById(div_name).style.height= height;
	}
	
	
function _0fff99388711cac8b387fc1f1e1bcb9bbef42c015ce749d7f3cfa513005fcfb9c9aed6371ccc4d87()
	{
	  		_23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b("about to call BG function to get google contacts info...");
			
			_23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b("Getting LATEST GOOGLE CONTACTS from BACKGROUND PAGE...");
			chrome.extension.sendRequest({greeting: "call_from_popup_to_check_contact_info"}, function(response) {
  		
  		_23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b("Google Contacts Token status per the BG page is: " + response.google_contacts_token_status);
  		
  		
  		if (response.google_contacts_token_status=='ACTIVE_GOOGLE_CONTACTS_TOKEN_STORED_LOCALLY') 
  			// there is an active OAUTH CONTACTS token, as reported by BG page.
  			
  			{
  			
		  		if (response.farewell==null)
		  			{
		  			_23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b("There was an active token, but no Google Contacts in BG page (array is null)");
		  			}
		  		else //there are google contacts in the array from BG page
		  			{
		  			_23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b("Getting LATEST GOOGLE CONTACTS from BACKGROUND PAGE..." + response.farewell.length + " contacts in array...");
		  			contacts=response.farewell;  		
		  			//NOTE: This is the local cache of the Google Contacts (from OAuth)
		  			}
  			}
  		
  		else  //no active OAUTH Contacts token -- show warning box, prompting user to go get new contacts token
  			{
  			
  						
			//  var link = '<img  align=BOTTOM src="error_icon.png" width=18 height=16 /> <span style="color:red"> Contacts Not Synced.</span> 
			// <a href="#" onclick="window.close();should_get_contacts_token_in_new_tab=true;setTimeout(\'_6d3fd5861333f0e7a869b9df63477e5bd1b6a239d6713c0203528addbbf93f7093e0a2c232b33178();\',1000);"> Sync Now with your Google Contacts</a> to see names instead of numbers';
			

  			}
  			
  	    
  	    SINGLE_MESSAGE__54b49173a3d065c6ac85b781feaafac6075c4b0ee2be08065255c376d837844b2bbad53aa5770ffd();

		_43cd2f9a9d5fbb864761f27e76b4277f4bb1b01fa48e7fbd323c7db52dcc224590790b3bfa999378();
		
		var wait_delay=0;
		
		//_23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b("wait delay is: " + wait_delay);
		
		//window.setTimeout('_43cd2f9a9d5fbb864761f27e76b4277f4bb1b01fa48e7fbd323c7db52dcc224590790b3bfa999378();',wait_delay); // we call this here as result of callback -- because it checks value of smsarray.length
		//we need SetTimeout because the value of smsarray.length wasn't populating in time for this eval!	
								
		
		});

	}
	


	
function _415ca9fb661c439ceab741c07cd1a8edf8ebb3b3f7275ff7221dd949be4ff917d859aab8ea6cdf25(){}
	
</script>

<body onload="
_3a5c6e75a23a68a0a08e68245dab4f92e034e9f41d23432b4c66cf0eea9abc6df51f6223ca671ed7();
_9364c95d7bd822a4751ea55b54fd880c7ef7c89f753f822ee660e26b1e43086a823087cf937b94c8();
_12b95204c684233b50f08bf65fe7996fe310b693929c010c8a4ba30eadae4de4da7c955f597ef04d();
">


	<script> 




	$(function() {
	// a workaround for a flaw in the demo system (http://dev.jqueryui.com/ticket/4375), ignore!
		$( "#dialog:ui-dialog" ).dialog( "destroy" );
	
		$( "#dialog-confirm" ).dialog({
			autoOpen: false,
			modal: true,
			buttons: {
				"Delete all items": function() {
					_5a364adc488d4403717ca81d4589905122d0755fa4a15d15b6e6fdf9c95a4de9b40896e3f89bee1e('xyz');
					$( this ).dialog( "close" );
				},
				Cancel: function() {
					$( this ).dialog( "close" );
				}
			}
		});
		
		$( "#opener" ).click(function() {
		$( "#dialog-confirm" ).dialog( "option", "position", [550,234] );
		$( "#dialog-confirm" ).dialog( "open" );
			return false;
		});
		
	});
		
	</script> 




<div id="resultholder" style="margin-bottom:20px">
	<div id="results"> 
	</div>
</div>

<div id="message-when-no-texts" style=""></div>

<p id="log" style="color: blue"></p>

<script>
		//removed this in dec 2010: 
		
      var resultdivclean = '<div id="results" style="display:none"></div>';

      var db;
      //var smsarray = new Array();
      var text_message_array = new Array();

      var localContactsArray = new Array();
      var log = document.getElementById('log');
	  var just_added_msg_id='';
	  
	  var google_username_currently_logged_in='contact@contact.com';

function _fe158ebafb51616c83138ecaf700f1d7fc370115e7818fc9eea51ce2179b907173217ad7a1236740()
	{
	
      smsarray = _bea166c49ce74ded6a00d850e591a6ab0fdea0db7156d814db6e54cc1608e0e3408dbce666a39b96();
      document.getElementById('results').addEventListener('click', function(e) { e.preventDefault(); }, false);
 	  
	}

function _1ab5a1b8b5e15644f372cb5ea3114befc07a8b7d8351a2027976ef549f0fc2416068f1b883b3824e(tx, error) 
	  {
        log.innerHTML += '<p>' + error.message + '</p>';
      }
      
      // select all records and display them
      
function _bea166c49ce74ded6a00d850e591a6ab0fdea0db7156d814db6e54cc1608e0e3408dbce666a39b96() {
        var localsmsarray = [];
        db.transaction(function(tx) {
          tx.executeSql("SELECT *,substr(from_phone_num,-7) AS right_digits_phone_num FROM Messages WHERE msgid=? ORDER BY from_phone_num,time_server", [which_msgid_from_hash_tag_in_url], function(tx, result) {
            for (var i = 0, item = null; i < result.rows.length; i++) {
              item = result.rows.item(i);
		      localsmsarray[i]= item;
		      text_message_array[i]=item;
            }
          }

          );

        });


      return(localsmsarray);
}


function _3a5c6e75a23a68a0a08e68245dab4f92e034e9f41d23432b4c66cf0eea9abc6df51f6223ca671ed7()
	{
                
        if (!db)
		{
		db = openDatabase("Texty", "1.0", "HTML5 Database API example", 200000);
		}
		
        db.transaction(function(tx) {
          tx.executeSql("SELECT COUNT(*) as cnt FROM sqlite_master where name='Messages'", [],
              function(tx,result) 
              	{ 
              		
              	var count=result.rows.item(0).cnt; 
              	_23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b("Row Count of Messages is " + count);
              	
              	if (count==0)
              		{
              		_dbf21e64709a6e3e26857675aada5f237ceebe8e6c8adafc663620e7955c759073abfd3ed29e70e2();
              		_23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b("Couldnt find table...creating...");
              		}
              	},
              _1ab5a1b8b5e15644f372cb5ea3114befc07a8b7d8351a2027976ef549f0fc2416068f1b883b3824e);
        });
        

        db.transaction(function(tx) {
          tx.executeSql("SELECT COUNT(*) as cnt FROM sqlite_master where name='LocalGoogleContacts'", [],
              function(tx,result) 
              	{ 
              		
              	var count=result.rows.item(0).cnt; 
              	_23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b("Row Count of LocalGoogleContacts is " + count);
              	
              	if (count==0)
              		{
              		_dbf21e64709a6e3e26857675aada5f237ceebe8e6c8adafc663620e7955c759073abfd3ed29e70e2();
              		_23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b("Couldnt find table...creating...");
              		}
              	},
              _1ab5a1b8b5e15644f372cb5ea3114befc07a8b7d8351a2027976ef549f0fc2416068f1b883b3824e);
        });


	
	}

      
      function _dbf21e64709a6e3e26857675aada5f237ceebe8e6c8adafc663620e7955c759073abfd3ed29e70e2() {
        db.transaction(function(tx) {
          tx.executeSql("CREATE TABLE Messages (id INTEGER PRIMARY KEY AUTOINCREMENT, googleusername TEXT, msgid TEXT UNIQUE, time_client DATE, time_server DATE, from_phone_num TEXT, body TEXT, type INTEGER, status INTEGER, source INTEGER)", [],
              function(tx) { _23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b("table Messages created"); },
              _1ab5a1b8b5e15644f372cb5ea3114befc07a8b7d8351a2027976ef549f0fc2416068f1b883b3824e);
        });


        db.transaction(function(tx) {
          tx.executeSql("CREATE TABLE LocalGoogleContacts (id INTEGER PRIMARY KEY AUTOINCREMENT, googleusername TEXT, phone_num TEXT UNIQUE, contact_name TEXT)", [],
              function(tx) { _23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b("table LocalGoogleContacts created"); },
              _1ab5a1b8b5e15644f372cb5ea3114befc07a8b7d8351a2027976ef549f0fc2416068f1b883b3824e);
        });

      }
      
      // add record with random values
      function _22cc2df1701eb123d8316990f971d591a8e994e4fbe971dbabaeaf508f12b411c395f852fde969d2() {
        //var num = Math.round(Math.random() * 100000); // random data
        db.transaction(function(tx) {
          tx.executeSql("INSERT INTO Messages (googleusername,msgid,time_client,time_server,from_phone_num,body,status,source) VALUES (?,?,?,?,?,?,?)",['m@gmail.com',1150731792,'02 October 2010, 0:58:00:01','02 October 2010, 0:58:00:01','+14042092929','Lets go grab a coffee ok?',0,0],
              function(tx, result) {
                log.innerHTML = 'record added';
                _bea166c49ce74ded6a00d850e591a6ab0fdea0db7156d814db6e54cc1608e0e3408dbce666a39b96();
              }, 
              _1ab5a1b8b5e15644f372cb5ea3114befc07a8b7d8351a2027976ef549f0fc2416068f1b883b3824e);
        });
      }
      
      function _93291b8d5d0ab940555f10c30536d9e0b2bcd9bd514263497d52a508f2b4fbf83eed5c619b6ead34(id, textEl) {
        db.transaction(function(tx) {
          tx.executeSql("UPDATE Messages SET googleusername = ? WHERE id = ?", [textEl.innerHTML, id], null, _1ab5a1b8b5e15644f372cb5ea3114befc07a8b7d8351a2027976ef549f0fc2416068f1b883b3824e);
        });
      }
      
      function _1eeacf63551c1215a1cd882c7dc511735e9a1a08ee8625704bfd0a4bef7906c023dd5da1f43ab7a7(msgid) {
        db.transaction(function(tx) {
          tx.executeSql("DELETE FROM Messages WHERE msgid=?", [msgid],
              function(tx, result) { 
              						_12b95204c684233b50f08bf65fe7996fe310b693929c010c8a4ba30eadae4de4da7c955f597ef04d('Deleted it!'); 
              						}, 
              _1ab5a1b8b5e15644f372cb5ea3114befc07a8b7d8351a2027976ef549f0fc2416068f1b883b3824e);
        });
      }

      function _5a364adc488d4403717ca81d4589905122d0755fa4a15d15b6e6fdf9c95a4de9b40896e3f89bee1e(sender_phone_num) {
        db.transaction(function(tx) {
          tx.executeSql("DELETE FROM Messages WHERE from_phone_num=?", [sender_phone_num],
              function(tx, result) { _12b95204c684233b50f08bf65fe7996fe310b693929c010c8a4ba30eadae4de4da7c955f597ef04d('Deleted all text messages from this person'); }, 
              _1ab5a1b8b5e15644f372cb5ea3114befc07a8b7d8351a2027976ef549f0fc2416068f1b883b3824e);
        });
      }


      function _7ccdedc993dcbae2e97dc2c30532d6601346ec9a61cbc971badf56b7c4b80fb5dbbf65ebf08effd7(msgid) {
        _23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b('in mark Read function');
        db.transaction(function(tx) {
          tx.executeSql("UPDATE Messages SET status=1 WHERE msgid=?", [msgid], function(tx, result) { _12b95204c684233b50f08bf65fe7996fe310b693929c010c8a4ba30eadae4de4da7c955f597ef04d(); }, _1ab5a1b8b5e15644f372cb5ea3114befc07a8b7d8351a2027976ef549f0fc2416068f1b883b3824e);
        });
      }

 function _b05f47309785c9f9f309c597bda84ea8f76505c0c5b05615f6f001e94b54d31f95f3793ea24d0cd8(msgid) {
        //_23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b('in mark success function');
        db.transaction(function(tx) {
          tx.executeSql("UPDATE Messages SET status=51 WHERE msgid=? and status=-99", [msgid], function(tx, result) { _12b95204c684233b50f08bf65fe7996fe310b693929c010c8a4ba30eadae4de4da7c955f597ef04d(); }, _1ab5a1b8b5e15644f372cb5ea3114befc07a8b7d8351a2027976ef549f0fc2416068f1b883b3824e);
        });
      }

      
// delete table from db
function _de4e90c60174cb811a9f29ac64e5b12064ceb5a159dc43d8813f621258c0268752575596f563a832() {
      
        db.transaction(function(tx) {
          tx.executeSql("DROP TABLE Messagestttt", [],
              function(tx) { _12b95204c684233b50f08bf65fe7996fe310b693929c010c8a4ba30eadae4de4da7c955f597ef04d(); }, 
              _1ab5a1b8b5e15644f372cb5ea3114befc07a8b7d8351a2027976ef549f0fc2416068f1b883b3824e);
        });
      
      
        db.transaction(function(tx) {
          tx.executeSql("DROP TABLE LocalGoogleContacts", [],
              function(tx) {localContactsArray=[];_12b95204c684233b50f08bf65fe7996fe310b693929c010c8a4ba30eadae4de4da7c955f597ef04d();}, 
              _1ab5a1b8b5e15644f372cb5ea3114befc07a8b7d8351a2027976ef549f0fc2416068f1b883b3824e);
        });
      
      
      
      
      
      }
      
      
    </script>





</body>


<script>


function _2b9c0dcda4499865c4d87e269b7d224e783688f040484356ed613195a4a7aac91e6a15378e1f000a() 
{
        db.transaction(function(tx) {
          tx.executeSql("SELECT * FROM LocalGoogleContacts", [], function(tx, result) {
            for (var i = 0, item = null; i < result.rows.length; i++) {
              item = result.rows.item(i);
		      localContactsArray[i]= item;
            }
            //document.getElementById('msg').innerHTML='Found ' + result.rows.length +  ' local contacts successfully' ; 
          }, function(tx, result) {document.getElementById('msg').innerHTML='FAILED to select fromLocalGoogleContacts -- create this table?';}

          );

        });

}


function _1f0c2be374a0153f49abdd71ed8da54ea25570df108d85109b999c28fc94fb586c333ad60df758b4()
{
_239b25b43284ba4ce9840d2eed474ff5b285e98844ae8e54b7f91e73d38204a429e746721f0bf2e3("resultholder","visible","300px");

document.getElementById('results').innerHTML = '';

document.getElementById('results').innerHTML += '<div id="compose-single-text" style="clear:both;font-size:18px">';
document.getElementById('results').innerHTML += '<p><B>Send To:</B></p> <input id="compose-number" type="text" name="compose-number" style="border:1px solid #CCC;margin:5px;padding:5px;font-size:14px" value="+13109862220"/><br><br>';

document.getElementById('results').innerHTML += '<p><B>Message:</B></p> <textarea id="send-one-text" value="starting val" onfocus="document.getElementById(\'error-text-content-single-text\').innerHTML=\'\';" style="hheight:60px;border:1px solid #CCC;margin:5px;padding:5px;font-size:14px"></textarea>';

document.getElementById('results').innerHTML += '<button style="font-size:12px;margin:0px;padding:10px;clear:both" onclick="_c5cf00bbdf61d0875c69e0797e58c9893eda0b78204c466e27c04b48f34fb26feb19a8f7c8aac8dd();"> Send</button>';

document.getElementById('results').innerHTML += '</div>';

document.getElementById('results').innerHTML += '<br><div id="error-text-content-single-text" style="font-weight:bold;color:red;font-size:14px"></div>';

	
}


function _6e72d6a14baec8319919163ce9043def03491abab3f8bbc602e3a34f7cbc8a3d97e1393a135562fc()
	{
	if (google_login_status)
		{
		return true;
		}
	else
		{
		document.getElementById('msg').innerHTML = '<br><span style="color:maroon;background-color:#FFF1A8">** Unable to send any new text messages until you sign in **</span>'
		
		return false;
		}
	}
	
function _9364c95d7bd822a4751ea55b54fd880c7ef7c89f753f822ee660e26b1e43086a823087cf937b94c8()
{
//document.getElementById('user-actions').innerHTML = '';
//document.getElementById('user-actions').innerHTML += '<button onclick="_12b95204c684233b50f08bf65fe7996fe310b693929c010c8a4ba30eadae4de4da7c955f597ef04d();">Refresh</button>';
//document.getElementById('user-actions').innerHTML += '<button onclick="if(_6e72d6a14baec8319919163ce9043def03491abab3f8bbc602e3a34f7cbc8a3d97e1393a135562fc()) {alert("hi");_1f0c2be374a0153f49abdd71ed8da54ea25570df108d85109b999c28fc94fb586c333ad60df758b4();}">Compose New</button>';       
}

function _72c91ffac1be23a82691605d8430a2c8f607312f3b11ee19dc21baa6a32f562721344d947ddc58d2()
{

}


function _c5cf00bbdf61d0875c69e0797e58c9893eda0b78204c466e27c04b48f34fb26feb19a8f7c8aac8dd()
{
var phonenumtosend = document.getElementById('compose-number').value;
phonenumtosend = _742e43c1ce7182e763b0ed93c36d6ed60ef960f611307768e6d77951256a33cc9abd40851f6f5ce8(phonenumtosend);
_63c8bebcb0332fca2dfc5fe328bec839e7df6dc4a6b7aac0060d64150291886a0b417c6c18103255("send-one-text",phonenumtosend,"single-text");   //the last param is used to identify which error box div to set/clear
}




function SINGLE_MESSAGE__54b49173a3d065c6ac85b781feaafac6075c4b0ee2be08065255c376d837844b2bbad53aa5770ffd()
{

var notif_style=3;  //decide whether user wants to see full verbose single text message, or just sender_name, or just "you got a text"
					//default is to set to verbose, then check Setting in Localstorage..
 if (window.localStorage == null) {
    _23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b('Local storage is not turned on...');
  		}
 else 
	   	{
	  	
	  	_23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b('Notif level from Local Storage is: ' + window.localStorage.notifLevel);
 		
 		
 		notif_style=window.localStorage.notifLevel;
 		
 		if (notif_style==undefined)
 			{
 			notif_style=3;
 			}
 		}  



var objDiv = new Array();
document.getElementById('resultholder').innerHTML = resultdivclean;

        db.transaction(function(tx) {
        
          tx.executeSql("SELECT *,substr(from_phone_num,-7) AS right_digits_phone_num FROM Messages WHERE msgid=? ORDER BY from_phone_num,time_server", [which_msgid_from_hash_tag_in_url], function(tx, result) {
            for (var i = 0, item = null; i < 1; i++) {  // MA note -- have to keep this in fake for loop :(
			
      var indexinputsms = 'inputsms-0';
      var count_sms_group=0;
      var phonenum_or_name='';
	  var current_date_time;
	  
	  var this_message_unread=new Boolean(false);
      
      _23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b("sms array length is " + smsarray.length);
      
      for (var i=0, current_phone_num = 'initial'; (i < smsarray.length); i++) 
      {
        
        
     // in case this incoming message has a contact thats not known yet, we need to set the google-username for the Local Contact insert
     // this global variable is used in texty.js by the function _9697e8314f1b76b7404ae29d4be9c68554d9acd3331e1d255a05f6eacba305c26cf6b87915a75428()
     
        google_username_currently_logged_in = smsarray[0]['googleusername'];
        
        this_message_unread=false;
		
      	if ((i==smsarray.length) || (current_phone_num != smsarray[i]['from_phone_num'])  )  //either we are at a NEW phone num block, or at the last message in this phone num block....so show the send sms input box
      		{
      			
			
			_23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b("Looking up rightmost digits: " + smsarray[i]['right_digits_phone_num'] + " -- in local contacts array");  






			var localContactInfoBothNameAndNumber = _4f5645f4eb91b42730be27e1029ad446c81d1382b98039782f4f68df506cd143b5015738ff3af2c1(smsarray[i]['right_digits_phone_num']);
			
			
			if (!(localContactInfoBothNameAndNumber==""))  //FOUND # in local contacts db
				{
				_23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b(smsarray[i]['right_digits_phone_num'] + " WAS  FOUND in Local Contacts DB");
				
				phonenum_or_name = localContactInfoBothNameAndNumber.contactNameLocalDB;
				
				}
			
			else //This contact was NOT found in local SQL DB Contacts table
				{
					_23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b(smsarray[i]['right_digits_phone_num'] + " NOT FOUND in Local Contacts DB -- getting latest Temp Synced G Contacts from Background Page");


					_23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b("Before refreshing from BG page: " + contacts.length + " contacts in Locally Temp Synced G Contacts OAuth array");  

                   
 
					_23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b("AFTER refreshing from BG page: " + contacts.length + " contacts in Locally Temp Synced G Contacts OAuth array");  
					

					_23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b("Currently: " + contacts.length + " contacts in Locally Temp Synced G Contacts OAuth array");  

					if (contacts.length==0) // no oauth contacts loaded into Google Contacts Temp Array this chrome extension user session
						{
						phonenum_or_name = smsarray[i]['from_phone_num'];
						_23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b("Will just display phone number - " + smsarray[i]['from_phone_num'] + " to user...");  

						//_6d3fd5861333f0e7a869b9df63477e5bd1b6a239d6713c0203528addbbf93f7093e0a2c232b33178();
						}
						
					if (contacts.length>0)
						{
					    _23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b("Looking up: " + smsarray[i]['right_digits_phone_num'] + " -- in Locally Temp Synced G Contacts OAuth array");  
						//now, try google-contacts-synced array for a match...
						
						
					
						//returns an array of the local name/number, or "" if not found locally
						var googleContactsInfoBothNameAndNumber = _63edc00dd64912451f2cb6b12f913cf60ed3f57c94f50977cfadb6b1d53fa2fcab084332d424d2b8(smsarray[i]['right_digits_phone_num'],smsarray[i]['from_phone_num']);


						//no Google Contact for this # in local g contacts syncd array
						if (googleContactsInfoBothNameAndNumber == '') 
							{
							_23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b(smsarray[i]['right_digits_phone_num'] + " NOT FOUND in Locally Temp Synced G Contacts OAuth array");				
							_23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b("Will just display phone number (last # in thread): " + smsarray[i]['from_phone_num']);
							
							//still no match, just show phone number
							phonenum_or_name = smsarray[i]['from_phone_num'];
							}
							
						else // A Google Contact WAS found in Locally Temp Synced G Contacts Oauth
						
							{
							phonenum_or_name = googleContactsInfoBothNameAndNumber.contactNamefromGoogleContactsArray;
							}
						
											
				
						}
	
				}
						
      	
      		}
	
		
	    if ( (smsarray[i]['status'])==0) // MA says - dont think we are using this anymore
	    	{
	    	this_message_unread=true;
	    	}

		var msg_type = smsarray[i]['type'];
		_23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b('msgtype is: ' + msg_type);
	
     	buildTextList = '<li class="sms-line-item">';


	    if  (msg_type==0) //incoming SMS 
	    	 
	    	{
	        _23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b("Processing incoming SMS Notif");
	      	if (notif_style==3) //full notif content from Options (user preference)
	      		{
	      		buildTextList += '<span style="color:#0087D2;font-size:15px"><B>' + phonenum_or_name + ':  </B></span>' + '<span class="sms-bodyy" style="font-size:14px">' + _049aa165db6223a076237384bec028620b7243d8787d41d9c35c57ef9e4aba799bacefac312149a4(smsarray[i]['body']) + '</span>  ' +
	        '<span class="sms-time">' + _3da4048ffc556b9d6c7ae43f64d7eed7675ef9843b38b789da2f768c8e9ad5c498ca6be82ff9febdDisplayPurposes(smsarray[i]['time_client']) + '</span>';
	      		}
	      	else if (notif_style==2)  // hide text content (user can click Show to see who texted them)
	      		{
	      		buildTextList += 'Text Message from ' + '<span style="color:#0087D2;font-size:15px"><B>' + phonenum_or_name + ':</B></span>' +  '<br><br> <a id="prompt-show" href="#" style="font-size:12px" onclick="_8c38704a2a88ad705bd145fbade827e335e01cf8db8d5602eb99f8998d6e03306faa5894dcfa3994();"> (show) </a>' + 
	      		'<span id="sms-content-show-or-hide" class="sms-bodyy" style="color:black;font-size:14px;display:none">' + smsarray[i]['body'] + '</span>  ' +
	        '<span class="sms-time">' + _3da4048ffc556b9d6c7ae43f64d7eed7675ef9843b38b789da2f768c8e9ad5c498ca6be82ff9febdDisplayPurposes(smsarray[i]['time_client']) + '</span>';
	      		}
	
	        buildTextList += '</li>';
	        
	        var reply_url = 'popup.html' + '#' + smsarray[i]['from_phone_num'];
	      	
	      	reply_url_global = reply_url;	//MA says we probably dont use this anymore as of June 2011	
	
			document.getElementById('resultholder').innerHTML += buildTextList;
	
			document.getElementById('resultholder').innerHTML += '<br>';
	
			
			var body_helper_full = smsarray[i]['body'];
			
	        
	        //need to clear CR/LF - MA had to make this a regex with G option to replace ALL instances of \n (previously was just doing regular replace() which was only clearing the 1st instance of \n)
			//var regex_pattern_string = "\n"; 
			//var re_newline = new RegExp(regex_pattern_string, "g");
			//var cleaned_newline_using_regex = body_helper_full.replace(re_newline,""); // there was a trailing CR/LF for some reason.
			//console.log("using regex - position of CRLF should be -1 since we removed all CRLFs. it is actually: " + cleaned_newline_using_regex.search("\n"));
			//console.log("First character: " + cleaned_newline_using_regex.charCodeAt(0));
			//console.log("Last character: " + cleaned_newline_using_regex.charCodeAt(cleaned_newline_using_regex.length-1));
	
			
			var cleaned_newline_using_regex = body_helper_full;
			
			cleaned_newline_using_regex = escape(cleaned_newline_using_regex);  // MA says -- escaping worked better than all regex stuff above
	
			document.getElementById('resultholder').innerHTML += '<a href="#" class="reply-button" style="margin-right:10px; text-decoration:none" onclick="_cdde5e0fbf741477a88bbbe2efb419ce4619730fdc7591928a0ded7500330e9c0c46dc8b69d93503(\'' + cleaned_newline_using_regex + '\', \'' + smsarray[i]['right_digits_phone_num'] + '\');_7869f2afc0158af85f593bc60124e314d9a1d58c4fc535ff885e31d70f5cd2c4c14b396ddae3ef78(\'' + reply_url + '\');_cccfd063b99f899232d571d89d3f832308c0d0bc391ba80d8f0493c44c4b51d18861e9e75d3d1dfa();window.close();"  >Reply</a>';
	
	document.getElementById('resultholder').innerHTML += '<a class="reply-button" style="color:#9A3030" onclick="_cdde5e0fbf741477a88bbbe2efb419ce4619730fdc7591928a0ded7500330e9c0c46dc8b69d93503(\'' + cleaned_newline_using_regex + '\', \'' + smsarray[i]['right_digits_phone_num'] + '\');_35e0f5f28d3b925513b5f2af9d5b810baa3bd878fa02d5536461ea2b52a917a9ad2e13e36598373c();window.close();">Close</a>';
	
	document.getElementById('resultholder').innerHTML += '<br>';
	
	//document.getElementById('resultholder').innerHTML += '<a class="reply-button" style="margin-top:20px" onclick="_fb0e48f80283faafa8ce50414f6cf2dbf581901f29e08539b5f7090cc2c3bec5b8dbcaef68fee64e(\'' + smsarray[i]['right_digits_phone_num'] + '\');window.close();">testing: mark whole thread as read</a>';

			} //end-if msgtype==0
			

	    else if ( (msg_type==80) || (msg_type==81) ) //calling now 
	    	 
	    	{
	        _23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b("Processing -- Incoming Call or Missed Call --  Notif");
	        
	      	if (notif_style<=3) //full notif content from Options (user preference)
	      		{
	      		
	      		if (msg_type==80) //calling now
	      		{
	      			setTimeout("window.close();",10000); //close this notif after about 10 seconds -- since its a calling now notif
	      			
	      			buildTextList += '<img align="left" height=50 width=50 src="img/phone-ringing.png">Incoming Call from<br><span style="color:#0087D2;font-size:17px"><B>' + phonenum_or_name + '</B></span>'  + '<br><span class="sms-time">' + _3da4048ffc556b9d6c7ae43f64d7eed7675ef9843b38b789da2f768c8e9ad5c498ca6be82ff9febdDisplayPurposes(smsarray[i]['time_client']) + '</span>';
	      			
	      		    

	      		}
	      		
	      		else if (msg_type==81) //missed call
	      		{
	      		
	      			buildTextList += '<img align="left" height=40 width=40 src="img/missed-call.png">Missed Call from<br><span style="color:#0087D2;font-size:17px"><B>' + phonenum_or_name + '</B></span>'  + '<br><span class="sms-time" style="margin-left:45px">' + _3da4048ffc556b9d6c7ae43f64d7eed7675ef9843b38b789da2f768c8e9ad5c498ca6be82ff9febdDisplayPurposes(smsarray[i]['time_client']) + '</span>';
	      		}
	      		
	      		
	      		}
	      	
	      	else if (notif_style==2)  // hide text content (user can click Show to see who texted them)
	      		{
	      		bbbbbbbbbuildTextList += 'Text Message from ' + '<span style="color:#0087D2;font-size:15px"><B>' + phonenum_or_name + ':</B></span>' +  '<br><br> <a id="prompt-show" href="#" style="font-size:12px" onclick="_8c38704a2a88ad705bd145fbade827e335e01cf8db8d5602eb99f8998d6e03306faa5894dcfa3994();"> (show) </a>' + 
	      		'<span id="sms-content-show-or-hide" class="sms-bodyy" style="color:black;font-size:14px;display:none">' + smsarray[i]['body'] + '</span>  ' +
	        '<span class="sms-time">' + _3da4048ffc556b9d6c7ae43f64d7eed7675ef9843b38b789da2f768c8e9ad5c498ca6be82ff9febdDisplayPurposes(smsarray[i]['time_client']) + '</span>';
	      		}
	
	        buildTextList += '</li>';
	        
	        var reply_url = 'popup.html' + '#' + smsarray[i]['from_phone_num'];
	      	
	
			document.getElementById('resultholder').innerHTML += buildTextList;
	
			document.getElementById('resultholder').innerHTML += '<br>';


			document.getElementById('resultholder').innerHTML += '<a href="#" class="reply-button" style="margin-right:10px; text-decoration:none" onclick="_7869f2afc0158af85f593bc60124e314d9a1d58c4fc535ff885e31d70f5cd2c4c14b396ddae3ef78(\'' + reply_url + '\');_cccfd063b99f899232d571d89d3f832308c0d0bc391ba80d8f0493c44c4b51d18861e9e75d3d1dfa();window.close();"  >Send SMS</a>';
			
			document.getElementById('resultholder').innerHTML += '<a class="reply-button" style="color:#9A3030" onclick="_35e0f5f28d3b925513b5f2af9d5b810baa3bd878fa02d5536461ea2b52a917a9ad2e13e36598373c();window.close();">Close</a>';
			}






			
			
			
			
			
			
			
			
			
			
			
					
		 }
		

		

    }
          }

          );

        });


}


function _cccfd063b99f899232d571d89d3f832308c0d0bc391ba80d8f0493c44c4b51d18861e9e75d3d1dfa()
{
_gaq.push(["_trackEvent","Alert-Notif-Popup","Reply-Click","",1]);
}


function _35e0f5f28d3b925513b5f2af9d5b810baa3bd878fa02d5536461ea2b52a917a9ad2e13e36598373c()
{
_gaq.push(["_trackEvent","Alert-Notif-Popup","Close-Notif-Click","",1]);
}


function _8c38704a2a88ad705bd145fbade827e335e01cf8db8d5602eb99f8998d6e03306faa5894dcfa3994()
	{
	$('#prompt-show').hide();

	$('#sms-content-show-or-hide').show();

	}
	
	
	
	
function _a4f17cbea592a68599b0a5e55d1681c80971955553a6593ea063a3cda52a0e5ef1ec89326dd75176() {
  chrome.tabs.getAllInWindow(undefined,function(tabs) {
    for (var i = 0, tab; tab = tabs[i]; i++) {
    _23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b("hi");
	document.getElementById('resultholder').innerHTML += 'ha';

    }
  });
}

function _36830e020d721075903367188e02801954d939f4d15dcfb80bdb6fe10dc7016cd7db1b0a5d3d1a26() {

chrome.windows.getAll({populate : true}, function (window_list) {
        var list = [];
        for(var i=0;i<window_list.length;i++) {
            list = list.concat(window_list[i].tabs);
            document.getElementById('resultholder').innerHTML += window_list[i].id;
            window_list[0][0].focused=true;
        }
        _23a72b4b1452794c76a05bc6804f1ad8aaf421813a425331cd8500cd360b87ec760ca2e0bd6ddd2b(list);
        
        	
    });
    
  }

function _7869f2afc0158af85f593bc60124e314d9a1d58c4fc535ff885e31d70f5cd2c4c14b396ddae3ef78(which_url) {

chrome.windows.create({url: which_url,
                       left: 10,
                       top: 10,
                       width: 810,
                       height: 610,
                       type: "popup"}, function(wnd) {
  });

}




function _28d3b14c1b8b10ebf611f865f811abbd5d108e5ef92878f18258dde6be466657afbe597f425f92bb(datestring)
{
var d = new Date(datestring);

var curr_min = d.getMinutes();

if (curr_min < 10)
   {
   curr_min = '0' + curr_min;
   }

return (curr_min);

}

function OLD__3da4048ffc556b9d6c7ae43f64d7eed7675ef9843b38b789da2f768c8e9ad5c498ca6be82ff9febd(datestring)
{
var d = new Date(datestring);

var curr_hour = d.getHours();
var curr_seconds = d.getSeconds();
var curr_min = d.getMinutes();
var curr_date = d.getDate();
var curr_month = d.getMonth();
var curr_year = d.getFullYear();

curr_month++;

if (curr_hour < 10)
   {
   curr_hour = '0' + curr_hour;
   }

if (curr_min < 10)
   {
   curr_min = '0' + curr_min;
   }

if (curr_month < 10)
   {
   curr_month = '0' + curr_month;
   }

if (curr_seconds < 10)
   {
   curr_seconds = '0' + curr_seconds;
   }




//return(curr_month + "/" + curr_date + "/" + curr_year + " " + curr_hour + ":" + curr_min + " " + a_p);

return(curr_year + "-" + curr_month + "-" + curr_date + " " + curr_hour + ":" + curr_min + ":" + curr_seconds);


//going for: YYYY-MM-DD HH:MM:SS

}







function _3da4048ffc556b9d6c7ae43f64d7eed7675ef9843b38b789da2f768c8e9ad5c498ca6be82ff9febdDisplayPurposes(datestring)
{
var a_p = "";
var d = new Date(datestring);

var curr_hour = d.getHours();

if (curr_hour < 12)
   {
   a_p = "AM";
   }
else
   {
   a_p = "PM";
   }
if (curr_hour == 0)
   {
   curr_hour = 12
   }
if (curr_hour > 12)
   {
   curr_hour = curr_hour - 12;
   }

var curr_min = d.getMinutes();

if (curr_min < 10)
   {
   curr_min = '0' + curr_min;
   }

var curr_date = d.getDate();
var curr_month = d.getMonth();
curr_month++;
var curr_year = d.getFullYear().toString().slice(2);


return(curr_month + "/" + curr_date + "/" + curr_year + " " + curr_hour + ":" + curr_min + " " + a_p);
}





</script>



    <script type="text/javascript">


function _742e43c1ce7182e763b0ed93c36d6ed60ef960f611307768e6d77951256a33cc9abd40851f6f5ce8(phonenum_to_check)
{
  				var phonenum_normalized = "";
  				var prefix_build = "";
  				
  				while (phonenum_to_check.search("[-]") > -1)  //need while loop as there may be up to 3 hyphens in phone number
  					{
  					phonenum_to_check = phonenum_to_check.replace("-", "");  //check for '-' within phone number and remove
  					}

  				while (phonenum_to_check.search("[ ]") > -1)  //need while loop as there may be up to 3 hyphens in phone number
  					{
  					phonenum_to_check = phonenum_to_check.replace(" ", "");  //check for '-' within phone number and remove
  					}

  				while (phonenum_to_check.search("[(]") > -1)  //need while loop as there may be up to 3 hyphens in phone number
  					{
  					phonenum_to_check = phonenum_to_check.replace("(", "");  //check for '-' within phone number and remove
  					}

  				while (phonenum_to_check.search("[)]") > -1)  //need while loop as there may be up to 3 hyphens in phone number
  					{
  					phonenum_to_check = phonenum_to_check.replace(")", "");  //check for '-' within phone number and remove
  					}
  				
  				if (phonenum_to_check.search("[+]") == -1)               //look for the leading "+" for country code...
  		            {
  		            if (phonenum_to_check.charAt(0)=="1")  //if it starts with a 1, then just add a +
  		            	prefix_build = "+";
  		            else
  		            	prefix_build = "+1";  //no "+" or "1", so add "+1"
  		        	}
  		        	
  				phonenum_normalized = prefix_build + phonenum_to_check;	 // VERY IMPORTANT

				return phonenum_normalized;
}








      function _040e7d229080fe1b7a7f04aef7081df3d5f7a4e9a3163b7935e1d7c8f0fb32ed0cd957e1e3bf7518() {
        //chrome.extension.getBackgroundPage()._040e7d229080fe1b7a7f04aef7081df3d5f7a4e9a3163b7935e1d7c8f0fb32ed0cd957e1e3bf7518();
        _040e7d229080fe1b7a7f04aef7081df3d5f7a4e9a3163b7935e1d7c8f0fb32ed0cd957e1e3bf7518();
        window.close();
      };
   
	
function _8e18be93b9ff59ec497fd589a9014218257d1d06b4f5a919031991a4f8273575bfb8a2e5852f25ae(){
	$(function() {
		
		if (selected_tab <=0) /* if there's not a known selected tab, such as when you first come into the panel*/
			{
			selected_tab = 0;  
			$("#sendbox-0-texts").scrollTop(10000+$("#sendbox-0-texts").height());
			}
		
	});
}



	</script>







</HTML>
