/**
 * Functions for popup
 *
 * @author              Warren Benedetto <warren@transfusionmedia.com>
 * @since               March 23, 2010
 * @version             1.0.24
 */function bg(){return chrome.extension.getBackgroundPage()}var Popup=function(){return{url:null,fullDomain:null,baseDomain:null,init:function(){this.url=bg().StayFocusd.currentURL,this.fullDomain=bg().DomainParser.extractFullDomain(this.url),this.baseDomain=bg().DomainParser.extractBaseDomain(this.url);var e=setInterval(Popup.updateDisplayTimer,1e3);$("a.close").click(function(){window.close()}),$(".base-domain").html(this.baseDomain),$(".full-domain").html(this.fullDomain),bg().StayFocusd.localizeHTML(document),this.initOptions()},initOptions:function(){$("#block-entire").click(function(){Popup.addToList(Popup.baseDomain,"black")}),$("#show-advanced-options").click(function(){$("#advanced-options").slideToggle("fast")}),$("#show-help").click(function(){Popup.showHelp()}),$("#show-options").click(function(){Popup.showOptions()}),$("#show-nuclear-option").click(function(){Popup.showOptions("nuclearOption")}),this.fullDomain!==this.baseDomain&&this.initFullDomainOptions(),$("#block-custom").click(function(){Popup.addToList($("#custom-url").val(),"black")}),$("#allow-custom").click(function(){Popup.addToList($("#custom-url").val(),"white")}),bg().StayFocusd.getLocal("hideAllowSiteLink")=="true"?$(".allow").hide():($("#allow-entire").show(),$("#allow-entire").click(function(){Popup.addToList(Popup.baseDomain,"white")}))},initFullDomainOptions:function(){var e='<li class="option"><a href="#" id="only-allow" class="allow">'+chrome.i18n.getMessage("onlyAllowPagesOn")+' <b class="full-domain">'+this.fullDomain+"</b></a></li>",t='<li class="option"><a href="#" id="only-block">'+chrome.i18n.getMessage("onlyBlockPagesOn")+' <b class="full-domain">'+this.fullDomain+"</b></a></li>";$("#advanced-options .options .option:first").after(e),$("#advanced-options .options .option:first").after(t),$("#only-block").click(function(){Popup.addToList(Popup.fullDomain,"black")}),$("#only-allow").click(function(){Popup.addToList(Popup.fullDomain,"white")})},updateDisplayTimer:function(){var e="";bg().StayFocusd.isActive()===!1?e=chrome.i18n.getMessage("inactive"):bg().NuclearOption.isActive()?e=chrome.i18n.getMessage("nuclear"):(e=bg().StayFocusd.getDisplayTimer(),e=="00:00:00"&&$("#display-timer").addClass("expired")),$("#display-timer").html(e)},showHelp:function(){var e=chrome.extension.getURL("help.html");chrome.tabs.create({url:e})},showOptions:function(e){typeof e=="undefined"&&(e="");var t=chrome.extension.getURL("options.html#"+e);chrome.tabs.create({url:t})},addToList:function(e,t){var n=!1;e!==""&&(t=="black"?n=bg().ListManager.addToBlacklist(e):n=bg().ListManager.addToWhitelist(e)),n===!0?($("#status-msg").removeClass("error"),$("#status-msg").addClass("success"),$("#status-msg").html(chrome.i18n.getMessage("success").toUpperCase()+"!"),setTimeout(function(){window.close()},1500)):($("#status-msg").removeClass("success"),$("#status-msg").addClass("error"),$("#status-msg").html(chrome.i18n.getMessage("error").toUpperCase()),setTimeout(function(){$("#status-msg").hide()},2e3)),$("#status-msg").show()}}}();$(document).ready(function(){Popup.init(),$("#showBlockedSitesOptions").click(function(){Popup.showOptions("blockedSites")})});