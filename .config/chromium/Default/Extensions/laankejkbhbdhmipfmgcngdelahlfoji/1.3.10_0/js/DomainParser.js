/**
 * Functions for parsing web domains: extracting base domains, full domains,
 * subdomains, url segments, etc.
 *
 * @author              Warren Benedetto <warren@transfusionmedia.com>
 * @since               January 15, 2010
 * @version             1.0.0
 */var DomainParser=function(){return{getCurrentURL:function(){chrome.tabs.getSelected(null,function(e){if(e!==undefined)return e.url})},extractFullDomain:function(e){var t=e.match(/:\/\/(.[^/]+)/);if(t==null||t.length<2){var n=e.split("/");return n[0]}return t[1]},extractBaseDomain:function(e){var t=this.extractFullDomain(e);if(t.length===0)return"";var n=t.split(".");if(n.length===1)return t;var r=n[n.length-1];return r=n[n.length-2]+"."+r,this.isMultiPartDomain(t)&&(r=n[n.length-3]+"."+r),r},extractURLSegments:function(e){var t={},n=[],r=[],i=[],s=e.split("?");if(s.length>1){var o=s[1];t.pairs=o.split("&")}return s[0]=this.stripProtocol(s[0]),t.path=s[0].split("/"),t.domain=t.path.shift().split("."),t},isMultiPartDomain:function(e){var t=e.split("."),n=[];if(t.length===1)return!1;var r=t[t.length-2];if(r.length==1)return!0;if(r.length==2&&t.length>3)return!0;if(r.length==3&&t.length>=3){n=["com","edu","gov","mil","net","org","biz","www","pro","int","web","xxx"];for(var i in n)if(n.hasOwnProperty(i)&&r==n[i])return!0}if(r.length==4&&t.length>=3){n=["info","mobi","name","jobs","kiwi","aero","asia","coop"];for(var s in n)if(n.hasOwnProperty(s)&&r==n[s])return!0}if(t.length>=3){var o=t[t.length-3];if(r.length==2&&t.length===3&&o.length>2&&o!=="www")return!0}return!1},isMoreGeneralURL:function(e,t){e=this.stripProtocol(e),t=this.stripProtocol(t);var n=this.extractBaseDomain(t);if(e==t)return!0;if(e==n)return!0;if(t.indexOf(e)===0)return!0;var r=this.extractBaseDomain(e);return r==n&&e.length<=t.length&&t.indexOf(e)>=0&&(t.indexOf("/")>=0||t.indexOf("?")>=0)?!0:n.length>r.length&&n.indexOf(e)===0?!0:!1},matchesWildcard:function(e,t){var n=e.replace("*","");if(t.indexOf(n)==-1)return!1;var r=t.substring(0,t.indexOf(n)+n.length),i=t.substring(r.length-n.length,r.length);return i===n},stripProtocol:function(e){return e.indexOf("://")>-1?e.slice(e.indexOf("://")+3,e.length):e},getParam:function(e,t){t=t==undefined?window.location.href:t,e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var n="[\\?&]"+e+"=([^&#]*)",r=new RegExp(n),i=r.exec(t);return i==null?"":i[1]}}}();